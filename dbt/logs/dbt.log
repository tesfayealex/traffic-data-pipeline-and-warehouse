

============================== 2022-07-22 11:37:30.296335 | 64c87596-71b4-40ae-b287-2994046ed0a5 ==============================
11:37:30.296342 [info ] [MainThread]: Running with dbt=1.1.1
11:37:30.296697 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
11:37:30.296813 [debug] [MainThread]: Tracking: tracking
11:37:30.314280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296b3921c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296b3920d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296b386ee0>]}
11:37:30.356818 [debug] [MainThread]: Executing "git --help"
11:37:30.360956 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
11:37:30.361432 [debug] [MainThread]: STDERR: "b''"
11:37:30.361863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296aa20c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296aa1bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296aa1beb0>]}


============================== 2022-07-22 13:07:46.328207 | 46419b6a-cc95-4f08-8505-b9fa1a29f856 ==============================
13:07:46.328213 [info ] [MainThread]: Running with dbt=1.1.1
13:07:46.328471 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:07:46.328572 [debug] [MainThread]: Tracking: tracking
13:07:46.342340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b7a8b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b7a7feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b7a7fee0>]}
13:07:46.386326 [debug] [MainThread]: Executing "git --help"
13:07:46.390273 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:07:46.390664 [debug] [MainThread]: STDERR: "b''"
13:07:46.391195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b70cdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b70e1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b70e1a30>]}


============================== 2022-07-22 13:08:44.828648 | c143731d-1cd7-48c5-9347-d71a77c852e0 ==============================
13:08:44.828654 [info ] [MainThread]: Running with dbt=1.1.1
13:08:44.828909 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:08:44.829011 [debug] [MainThread]: Tracking: tracking
13:08:44.843264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d76b56070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d76b4af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d76b4af70>]}
13:08:44.882398 [debug] [MainThread]: Executing "git --help"
13:08:44.886947 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:08:44.887239 [debug] [MainThread]: STDERR: "b''"
13:08:44.887530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d7618efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d761aba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d761abaf0>]}


============================== 2022-07-22 13:09:12.860371 | 1279c0d8-5eb3-4669-b340-45750a9673ee ==============================
13:09:12.860377 [info ] [MainThread]: Running with dbt=1.1.1
13:09:12.860617 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:09:12.860719 [debug] [MainThread]: Tracking: tracking
13:09:12.875401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86494550a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86494550d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8649449fa0>]}
13:09:12.912489 [debug] [MainThread]: Executing "git --help"
13:09:12.916581 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:09:12.916863 [debug] [MainThread]: STDERR: "b''"
13:09:12.917110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8648a942b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8648a8eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8648a8ebb0>]}


============================== 2022-07-22 13:10:14.069770 | 81c2f0e3-196e-4451-83de-eb23c2b7557d ==============================
13:10:14.069776 [info ] [MainThread]: Running with dbt=1.1.1
13:10:14.070021 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:10:14.070122 [debug] [MainThread]: Tracking: tracking
13:10:14.083703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598969d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5989691f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5989691f70>]}
13:10:14.124607 [debug] [MainThread]: Executing "git --help"
13:10:14.129513 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:10:14.129809 [debug] [MainThread]: STDERR: "b''"
13:10:14.132978 [debug] [MainThread]: Acquiring new postgres connection "debug"
13:10:14.133385 [debug] [MainThread]: Using postgres connection "debug"
13:10:14.133504 [debug] [MainThread]: On debug: select 1 as id
13:10:14.133610 [debug] [MainThread]: Opening a new connection, currently in state init
13:10:14.140986 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
13:10:14.141739 [debug] [MainThread]: On debug: Close
13:10:14.142055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5988ce6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5988ce68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5988ce6cd0>]}
13:10:15.387454 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-22 13:10:30.742948 | 7c1288bb-d0e4-4c03-a97e-677a9b2b5196 ==============================
13:10:30.742954 [info ] [MainThread]: Running with dbt=1.1.1
13:10:30.743193 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:10:30.743296 [debug] [MainThread]: Tracking: tracking
13:10:30.757263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edde4c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edde40e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edde40fa0>]}
13:10:30.796549 [debug] [MainThread]: Executing "git --help"
13:10:30.800384 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:10:30.800678 [debug] [MainThread]: STDERR: "b''"
13:10:30.803232 [debug] [MainThread]: Acquiring new postgres connection "debug"
13:10:30.803745 [debug] [MainThread]: Using postgres connection "debug"
13:10:30.803884 [debug] [MainThread]: On debug: select 1 as id
13:10:30.803991 [debug] [MainThread]: Opening a new connection, currently in state init
13:10:30.810941 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
13:10:30.811800 [debug] [MainThread]: On debug: Close
13:10:30.812174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edd48c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edd48ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1edd48c9a0>]}
13:10:31.852885 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-22 13:11:50.994850 | a86c7269-e572-4a2c-864e-869e1ad16586 ==============================
13:11:50.994862 [info ] [MainThread]: Running with dbt=1.1.1
13:11:50.995287 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:11:50.995408 [debug] [MainThread]: Tracking: tracking
13:11:51.012491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2a229be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2a229cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2a229ca0>]}
13:11:51.023704 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:11:51.024017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a86c7269-e572-4a2c-864e-869e1ad16586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2a248e20>]}
13:11:51.034341 [debug] [MainThread]: Parsing macros/relations.sql
13:11:51.036257 [debug] [MainThread]: Parsing macros/adapters.sql
13:11:51.051646 [debug] [MainThread]: Parsing macros/catalog.sql
13:11:51.053939 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
13:11:51.055625 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:11:51.057893 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:11:51.059066 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:11:51.060080 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:11:51.060602 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:11:51.061023 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:11:51.061907 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:11:51.062412 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:11:51.063701 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:11:51.065888 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:11:51.075410 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:11:51.078868 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:11:51.079768 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:11:51.089155 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:11:51.094685 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:11:51.103878 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:11:51.106403 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:11:51.108034 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:11:51.112494 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:11:51.116418 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:11:51.117728 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:11:51.118481 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:11:51.119996 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:11:51.125994 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:11:51.135325 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:11:51.136281 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:11:51.143391 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:11:51.144422 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:11:51.145395 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:11:51.147971 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:11:51.152667 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:11:51.155150 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:11:51.159081 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:11:51.160804 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:11:51.162338 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:11:51.164770 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:11:51.170118 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:11:51.171358 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:11:51.176588 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:11:51.282474 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
13:11:51.289879 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
13:11:51.319848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a86c7269-e572-4a2c-864e-869e1ad16586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d29337ee0>]}
13:11:51.322580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a86c7269-e572-4a2c-864e-869e1ad16586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d29372f40>]}
13:11:51.322786 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:11:51.322994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a86c7269-e572-4a2c-864e-869e1ad16586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d29358ca0>]}
13:11:51.323915 [info ] [MainThread]: 
13:11:51.324276 [debug] [MainThread]: Acquiring new postgres connection "master"
13:11:51.324984 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
13:11:51.331227 [debug] [ThreadPool]: Using postgres connection "list_trial"
13:11:51.331410 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
13:11:51.331510 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:11:51.338673 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
13:11:51.339972 [debug] [ThreadPool]: On list_trial: Close
13:11:51.340937 [debug] [ThreadPool]: Acquiring new postgres connection "create_trial_trial"
13:11:51.341190 [debug] [ThreadPool]: Acquiring new postgres connection "create_trial_trial"
13:11:51.341411 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='trial', schema='trial', identifier=None)"
13:11:51.345231 [debug] [ThreadPool]: Using postgres connection "create_trial_trial"
13:11:51.345346 [debug] [ThreadPool]: On create_trial_trial: BEGIN
13:11:51.345431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:11:51.350189 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
13:11:51.350306 [debug] [ThreadPool]: Using postgres connection "create_trial_trial"
13:11:51.350394 [debug] [ThreadPool]: On create_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "create_trial_trial"} */
create schema if not exists "trial"
13:11:51.351081 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
13:11:51.351611 [debug] [ThreadPool]: On create_trial_trial: COMMIT
13:11:51.351751 [debug] [ThreadPool]: Using postgres connection "create_trial_trial"
13:11:51.351851 [debug] [ThreadPool]: On create_trial_trial: COMMIT
13:11:51.352878 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
13:11:51.353012 [debug] [ThreadPool]: On create_trial_trial: Close
13:11:51.353950 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
13:11:51.358409 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
13:11:51.358674 [debug] [ThreadPool]: On list_trial_trial: BEGIN
13:11:51.358777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:11:51.364332 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
13:11:51.364512 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
13:11:51.364598 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
13:11:51.365930 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
13:11:51.366636 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
13:11:51.366829 [debug] [ThreadPool]: On list_trial_trial: Close
13:11:51.369739 [debug] [MainThread]: Using postgres connection "master"
13:11:51.369886 [debug] [MainThread]: On master: BEGIN
13:11:51.369981 [debug] [MainThread]: Opening a new connection, currently in state init
13:11:51.374571 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:11:51.374696 [debug] [MainThread]: Using postgres connection "master"
13:11:51.374778 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:11:51.381451 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
13:11:51.382264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a86c7269-e572-4a2c-864e-869e1ad16586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d29372580>]}
13:11:51.382496 [debug] [MainThread]: On master: ROLLBACK
13:11:51.382719 [debug] [MainThread]: Using postgres connection "master"
13:11:51.382809 [debug] [MainThread]: On master: BEGIN
13:11:51.382953 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:11:51.383042 [debug] [MainThread]: On master: COMMIT
13:11:51.383123 [debug] [MainThread]: Using postgres connection "master"
13:11:51.383199 [debug] [MainThread]: On master: COMMIT
13:11:51.383330 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:11:51.383421 [debug] [MainThread]: On master: Close
13:11:51.383706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:11:51.383928 [info ] [MainThread]: 
13:11:51.386478 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
13:11:51.386724 [info ] [Thread-1  ]: 1 of 2 START table model trial.my_first_dbt_model .............................. [RUN]
13:11:51.387137 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
13:11:51.387289 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
13:11:51.387415 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
13:11:51.388897 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
13:11:51.389158 [debug] [Thread-1  ]: finished collecting timing info
13:11:51.389272 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
13:11:51.406714 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
13:11:51.407459 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
13:11:51.407677 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
13:11:51.407862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:11:51.416594 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
13:11:51.416890 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
13:11:51.417053 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
13:11:51.418446 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
13:11:51.424522 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
13:11:51.424789 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
13:11:51.425613 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
13:11:51.433402 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
13:11:51.433562 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
13:11:51.433653 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
13:11:51.434836 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
13:11:51.437631 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
13:11:51.437762 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
13:11:51.438083 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
13:11:51.438837 [debug] [Thread-1  ]: finished collecting timing info
13:11:51.438980 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
13:11:51.439397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a86c7269-e572-4a2c-864e-869e1ad16586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d28a9bd00>]}
13:11:51.439677 [info ] [Thread-1  ]: 1 of 2 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.05s]
13:11:51.440059 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
13:11:51.440770 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
13:11:51.440973 [info ] [Thread-1  ]: 2 of 2 START view model trial.my_second_dbt_model .............................. [RUN]
13:11:51.441469 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
13:11:51.441670 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
13:11:51.441902 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
13:11:51.443862 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
13:11:51.444089 [debug] [Thread-1  ]: finished collecting timing info
13:11:51.444205 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
13:11:51.459833 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
13:11:51.460143 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
13:11:51.460249 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
13:11:51.460331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:11:51.465700 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
13:11:51.466015 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
13:11:51.466146 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
13:11:51.469156 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
13:11:51.471039 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
13:11:51.471165 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
13:11:51.471444 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
13:11:51.472283 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
13:11:51.472397 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
13:11:51.472488 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
13:11:51.473587 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
13:11:51.474643 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
13:11:51.474753 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
13:11:51.474958 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
13:11:51.475576 [debug] [Thread-1  ]: finished collecting timing info
13:11:51.475703 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
13:11:51.476117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a86c7269-e572-4a2c-864e-869e1ad16586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d28275e50>]}
13:11:51.476386 [info ] [Thread-1  ]: 2 of 2 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.03s]
13:11:51.476680 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
13:11:51.477395 [debug] [MainThread]: Acquiring new postgres connection "master"
13:11:51.477521 [debug] [MainThread]: Using postgres connection "master"
13:11:51.477611 [debug] [MainThread]: On master: BEGIN
13:11:51.477698 [debug] [MainThread]: Opening a new connection, currently in state closed
13:11:51.483213 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
13:11:51.483410 [debug] [MainThread]: On master: COMMIT
13:11:51.483511 [debug] [MainThread]: Using postgres connection "master"
13:11:51.483605 [debug] [MainThread]: On master: COMMIT
13:11:51.483860 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:11:51.483997 [debug] [MainThread]: On master: Close
13:11:51.484378 [info ] [MainThread]: 
13:11:51.484583 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.16s.
13:11:51.484762 [debug] [MainThread]: Connection 'master' was properly closed.
13:11:51.484902 [debug] [MainThread]: Connection 'model.datawarehouse.my_second_dbt_model' was properly closed.
13:11:51.489358 [info ] [MainThread]: 
13:11:51.489748 [info ] [MainThread]: [32mCompleted successfully[0m
13:11:51.490127 [info ] [MainThread]: 
13:11:51.490413 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
13:11:51.490775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d2a254040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d28279550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d292f3ee0>]}


============================== 2022-07-23 08:37:28.507565 | 7a4b3d9d-9347-4a4b-b3ac-b56de2e95345 ==============================
08:37:28.507572 [info ] [MainThread]: Running with dbt=1.1.1
08:37:28.507840 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
08:37:28.507957 [debug] [MainThread]: Tracking: tracking
08:37:28.531860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abdb7c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abdb70e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abdb70fa0>]}
08:37:28.589529 [debug] [MainThread]: Executing "git --help"
08:37:28.596206 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
08:37:28.596660 [debug] [MainThread]: STDERR: "b''"
08:37:28.600306 [debug] [MainThread]: Acquiring new postgres connection "debug"
08:37:28.600828 [debug] [MainThread]: Using postgres connection "debug"
08:37:28.600973 [debug] [MainThread]: On debug: select 1 as id
08:37:28.601104 [debug] [MainThread]: Opening a new connection, currently in state init
08:37:28.617347 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
08:37:28.618753 [debug] [MainThread]: On debug: Close
08:37:28.619244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abd1c3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abd1c3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4abd1c39a0>]}
08:37:29.875687 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-23 08:37:33.307934 | 55648293-7ab5-4b04-a835-c4af15baeda7 ==============================
08:37:33.307952 [info ] [MainThread]: Running with dbt=1.1.1
08:37:33.308440 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:37:33.308580 [debug] [MainThread]: Tracking: tracking
08:37:33.329796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62440d0c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62440d0d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62440d0d00>]}
08:37:33.361666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
08:37:33.362042 [debug] [MainThread]: Partial parsing: added file: datawarehouse://models/example/traffic_dbt_model.sql
08:37:33.362389 [debug] [MainThread]: Partial parsing: update schema file: datawarehouse://models/example/schema.yml
08:37:33.372875 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_dbt_model.sql
08:37:33.392707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55648293-7ab5-4b04-a835-c4af15baeda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62431de430>]}
08:37:33.395753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55648293-7ab5-4b04-a835-c4af15baeda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6244091d00>]}
08:37:33.396004 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:37:33.396269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55648293-7ab5-4b04-a835-c4af15baeda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6244091f70>]}
08:37:33.397577 [info ] [MainThread]: 
08:37:33.398107 [debug] [MainThread]: Acquiring new postgres connection "master"
08:37:33.399089 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
08:37:33.408224 [debug] [ThreadPool]: Using postgres connection "list_trial"
08:37:33.408471 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
08:37:33.408619 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:37:33.418555 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
08:37:33.420089 [debug] [ThreadPool]: On list_trial: Close
08:37:33.421916 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
08:37:33.426953 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
08:37:33.427133 [debug] [ThreadPool]: On list_trial_trial: BEGIN
08:37:33.427272 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:37:33.435482 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:37:33.435713 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
08:37:33.435878 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
08:37:33.437693 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
08:37:33.438729 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
08:37:33.439024 [debug] [ThreadPool]: On list_trial_trial: Close
08:37:33.443269 [debug] [MainThread]: Using postgres connection "master"
08:37:33.443622 [debug] [MainThread]: On master: BEGIN
08:37:33.443872 [debug] [MainThread]: Opening a new connection, currently in state init
08:37:33.452180 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:37:33.452415 [debug] [MainThread]: Using postgres connection "master"
08:37:33.452563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:37:33.463289 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
08:37:33.464354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55648293-7ab5-4b04-a835-c4af15baeda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6244059ee0>]}
08:37:33.464617 [debug] [MainThread]: On master: ROLLBACK
08:37:33.464811 [debug] [MainThread]: Using postgres connection "master"
08:37:33.464940 [debug] [MainThread]: On master: BEGIN
08:37:33.465144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:37:33.465268 [debug] [MainThread]: On master: COMMIT
08:37:33.465376 [debug] [MainThread]: Using postgres connection "master"
08:37:33.465483 [debug] [MainThread]: On master: COMMIT
08:37:33.465630 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:37:33.465753 [debug] [MainThread]: On master: Close
08:37:33.466335 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:37:33.466648 [info ] [MainThread]: 
08:37:33.469610 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
08:37:33.469907 [info ] [Thread-1  ]: 1 of 3 START table model trial.my_first_dbt_model .............................. [RUN]
08:37:33.470825 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
08:37:33.471018 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
08:37:33.471206 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
08:37:33.473337 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
08:37:33.473673 [debug] [Thread-1  ]: finished collecting timing info
08:37:33.473843 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
08:37:33.496077 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
08:37:33.496607 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
08:37:33.496809 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
08:37:33.496964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:37:33.505086 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:37:33.505358 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
08:37:33.505492 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
08:37:33.507743 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
08:37:33.514306 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
08:37:33.514589 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
08:37:33.515263 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:37:33.518025 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
08:37:33.518229 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
08:37:33.518806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:37:33.528290 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
08:37:33.528594 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
08:37:33.529074 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
08:37:33.530747 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:37:33.535891 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
08:37:33.536108 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
08:37:33.538985 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
08:37:33.540055 [debug] [Thread-1  ]: finished collecting timing info
08:37:33.540231 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
08:37:33.540682 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55648293-7ab5-4b04-a835-c4af15baeda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6242149550>]}
08:37:33.541016 [info ] [Thread-1  ]: 1 of 3 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.07s]
08:37:33.541426 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
08:37:33.541629 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
08:37:33.542106 [info ] [Thread-1  ]: 2 of 3 START view model trial.traffic_dbt_model ................................ [RUN]
08:37:33.542831 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
08:37:33.543020 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
08:37:33.543197 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
08:37:33.545175 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
08:37:33.545460 [debug] [Thread-1  ]: finished collecting timing info
08:37:33.545601 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
08:37:33.562751 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
08:37:33.563133 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
08:37:33.563306 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
08:37:33.563437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:37:33.571934 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:37:33.572194 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
08:37:33.572342 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
08:37:33.573226 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "source_data" does not exist
LINE 23: from source_data
              ^

08:37:33.573839 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: ROLLBACK
08:37:33.574529 [debug] [Thread-1  ]: finished collecting timing info
08:37:33.574833 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
08:37:33.575504 [debug] [Thread-1  ]: Database Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)
  relation "source_data" does not exist
  LINE 23: from source_data
                ^
  compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
08:37:33.576192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55648293-7ab5-4b04-a835-c4af15baeda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62410f5550>]}
08:37:33.576779 [error] [Thread-1  ]: 2 of 3 ERROR creating view model trial.traffic_dbt_model ....................... [[31mERROR[0m in 0.03s]
08:37:33.577497 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
08:37:33.577785 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
08:37:33.578408 [info ] [Thread-1  ]: 3 of 3 START view model trial.my_second_dbt_model .............................. [RUN]
08:37:33.579241 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
08:37:33.579477 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
08:37:33.579700 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
08:37:33.583359 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
08:37:33.584033 [debug] [Thread-1  ]: finished collecting timing info
08:37:33.584405 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
08:37:33.588172 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
08:37:33.588753 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
08:37:33.589045 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
08:37:33.589292 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:37:33.598616 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:37:33.598982 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
08:37:33.599225 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
08:37:33.601085 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
08:37:33.605203 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
08:37:33.605542 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
08:37:33.606201 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:37:33.607967 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
08:37:33.608202 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
08:37:33.608386 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
08:37:33.609852 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:37:33.612127 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
08:37:33.612355 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
08:37:33.612746 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
08:37:33.614165 [debug] [Thread-1  ]: finished collecting timing info
08:37:33.614415 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
08:37:33.615127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55648293-7ab5-4b04-a835-c4af15baeda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62440d0d00>]}
08:37:33.615620 [info ] [Thread-1  ]: 3 of 3 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.04s]
08:37:33.616264 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
08:37:33.617632 [debug] [MainThread]: Acquiring new postgres connection "master"
08:37:33.620260 [debug] [MainThread]: Using postgres connection "master"
08:37:33.620612 [debug] [MainThread]: On master: BEGIN
08:37:33.620920 [debug] [MainThread]: Opening a new connection, currently in state closed
08:37:33.630659 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:37:33.631098 [debug] [MainThread]: On master: COMMIT
08:37:33.631389 [debug] [MainThread]: Using postgres connection "master"
08:37:33.631656 [debug] [MainThread]: On master: COMMIT
08:37:33.632009 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:37:33.632278 [debug] [MainThread]: On master: Close
08:37:33.633089 [info ] [MainThread]: 
08:37:33.633590 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.24s.
08:37:33.634696 [debug] [MainThread]: Connection 'master' was properly closed.
08:37:33.634984 [debug] [MainThread]: Connection 'list_trial' was properly closed.
08:37:33.635200 [debug] [MainThread]: Connection 'model.datawarehouse.my_second_dbt_model' was properly closed.
08:37:33.641627 [info ] [MainThread]: 
08:37:33.642448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:37:33.643031 [info ] [MainThread]: 
08:37:33.643526 [error] [MainThread]: [33mDatabase Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)[0m
08:37:33.643951 [error] [MainThread]:   relation "source_data" does not exist
08:37:33.644398 [error] [MainThread]:   LINE 23: from source_data
08:37:33.644849 [error] [MainThread]:                 ^
08:37:33.645149 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
08:37:33.645553 [info ] [MainThread]: 
08:37:33.645910 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
08:37:33.646385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f624405d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6244091d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62431c35e0>]}


============================== 2022-07-23 15:36:14.707093 | a6a67727-bd74-44d7-a03b-33ef565fd793 ==============================
15:36:14.707104 [info ] [MainThread]: Running with dbt=1.1.1
15:36:14.707580 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
15:36:14.707717 [debug] [MainThread]: Tracking: tracking
15:36:14.725558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee59b1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee59b1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee59b1cd0>]}
15:36:14.743784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:36:14.743942 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:36:14.747599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6a67727-bd74-44d7-a03b-33ef565fd793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee58d6c40>]}
15:36:14.751020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6a67727-bd74-44d7-a03b-33ef565fd793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee595a340>]}
15:36:14.751249 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:36:14.751448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a67727-bd74-44d7-a03b-33ef565fd793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee595a520>]}
15:36:14.752406 [info ] [MainThread]: 
15:36:14.752808 [debug] [MainThread]: Acquiring new postgres connection "master"
15:36:14.753705 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
15:36:14.760026 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
15:36:14.760155 [debug] [ThreadPool]: On list_trial_trial: BEGIN
15:36:14.760272 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:36:14.766640 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:36:14.766835 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
15:36:14.766942 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
15:36:14.768660 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:36:14.769779 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
15:36:14.770088 [debug] [ThreadPool]: On list_trial_trial: Close
15:36:14.774604 [debug] [MainThread]: Using postgres connection "master"
15:36:14.774851 [debug] [MainThread]: On master: BEGIN
15:36:14.775042 [debug] [MainThread]: Opening a new connection, currently in state init
15:36:14.781143 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:36:14.781337 [debug] [MainThread]: Using postgres connection "master"
15:36:14.781439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:36:14.793160 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:36:14.794848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a67727-bd74-44d7-a03b-33ef565fd793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee593dca0>]}
15:36:14.795169 [debug] [MainThread]: On master: ROLLBACK
15:36:14.795428 [debug] [MainThread]: On master: Close
15:36:14.795808 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:36:14.796033 [info ] [MainThread]: 
15:36:14.798170 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
15:36:14.798511 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
15:36:14.798642 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
15:36:14.798761 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
15:36:14.800486 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
15:36:14.800746 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.800876 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
15:36:14.801003 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.801385 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
15:36:14.801530 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
15:36:14.801836 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
15:36:14.802128 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
15:36:14.802230 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
15:36:14.803988 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
15:36:14.804314 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.804454 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
15:36:14.804560 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.804876 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
15:36:14.805010 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
15:36:14.805294 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
15:36:14.805402 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
15:36:14.805514 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
15:36:14.807436 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
15:36:14.807741 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.807872 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
15:36:14.807979 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.808400 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
15:36:14.808542 [debug] [Thread-1  ]: Began running node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
15:36:14.809072 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710"
15:36:14.809220 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
15:36:14.809341 [debug] [Thread-1  ]: Compiling test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
15:36:14.817378 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710"
15:36:14.817655 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.817782 [debug] [Thread-1  ]: Began executing node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
15:36:14.817889 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.818195 [debug] [Thread-1  ]: Finished running node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
15:36:14.818346 [debug] [Thread-1  ]: Began running node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
15:36:14.818714 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.unique_my_first_dbt_model_id.16e066b321"
15:36:14.818835 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
15:36:14.818935 [debug] [Thread-1  ]: Compiling test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
15:36:14.824897 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.unique_my_first_dbt_model_id.16e066b321"
15:36:14.825167 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.825311 [debug] [Thread-1  ]: Began executing node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
15:36:14.825430 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.825798 [debug] [Thread-1  ]: Finished running node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
15:36:14.825957 [debug] [Thread-1  ]: Began running node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
15:36:14.826264 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778"
15:36:14.826385 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
15:36:14.826499 [debug] [Thread-1  ]: Compiling test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
15:36:14.828840 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778"
15:36:14.829033 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.829144 [debug] [Thread-1  ]: Began executing node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
15:36:14.829261 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.829561 [debug] [Thread-1  ]: Finished running node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
15:36:14.829686 [debug] [Thread-1  ]: Began running node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
15:36:14.829945 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493"
15:36:14.830048 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
15:36:14.830139 [debug] [Thread-1  ]: Compiling test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
15:36:14.832320 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493"
15:36:14.832524 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.832637 [debug] [Thread-1  ]: Began executing node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
15:36:14.832738 [debug] [Thread-1  ]: finished collecting timing info
15:36:14.833003 [debug] [Thread-1  ]: Finished running node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
15:36:14.833521 [debug] [MainThread]: Connection 'master' was properly closed.
15:36:14.833665 [debug] [MainThread]: Connection 'test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
15:36:14.836208 [info ] [MainThread]: Done.
15:36:14.838792 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
15:36:14.838940 [info ] [MainThread]: Building catalog
15:36:14.839865 [debug] [ThreadPool]: Acquiring new postgres connection "trial.information_schema"
15:36:14.844900 [debug] [ThreadPool]: Using postgres connection "trial.information_schema"
15:36:14.845065 [debug] [ThreadPool]: On trial.information_schema: BEGIN
15:36:14.845165 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:36:14.850361 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:36:14.850505 [debug] [ThreadPool]: Using postgres connection "trial.information_schema"
15:36:14.850622 [debug] [ThreadPool]: On trial.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "trial.information_schema"} */

    
    

    select
        'trial' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('trial'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
15:36:14.853613 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:36:14.857314 [debug] [ThreadPool]: On trial.information_schema: ROLLBACK
15:36:14.857542 [debug] [ThreadPool]: On trial.information_schema: Close
15:36:14.861350 [info ] [MainThread]: Catalog written to /home/hp/Downloads/datawarehouse/target/catalog.json
15:36:14.861658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee59b1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee403ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee403cb50>]}
15:36:16.259832 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
15:36:16.260826 [debug] [MainThread]: Connection 'trial.information_schema' was properly closed.


============================== 2022-07-23 15:37:32.214416 | bd75915c-3f02-480d-a929-ecbf28f08a69 ==============================
15:37:32.214428 [info ] [MainThread]: Running with dbt=1.1.1
15:37:32.214796 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
15:37:32.214929 [debug] [MainThread]: Tracking: tracking
15:37:32.228965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a435b8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a435b8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a435b8d30>]}
15:37:32.230691 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
15:37:32.230966 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
15:37:32.231148 [info ] [MainThread]: 
15:37:32.231310 [info ] [MainThread]: 
15:37:32.231609 [info ] [MainThread]: Press Ctrl+C to exit.
15:37:32.232083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a435b88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a435cf070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a435cf0d0>]}


============================== 2022-07-23 15:37:54.466726 | 4a6e8e81-9ab2-4378-8b92-1cc2d436302d ==============================
15:37:54.466737 [info ] [MainThread]: Running with dbt=1.1.1
15:37:54.467120 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 7000, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
15:37:54.467232 [debug] [MainThread]: Tracking: tracking
15:37:54.484375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4c249ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4c249d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4c249d60>]}
15:37:54.486503 [info ] [MainThread]: Serving docs at 0.0.0.0:7000
15:37:54.486893 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:7000
15:37:54.487114 [info ] [MainThread]: 
15:37:54.487392 [info ] [MainThread]: 
15:37:54.487651 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-07-23 18:56:28.751265 | 6fcf76f7-e5cc-4cd8-9e8b-bce1eca58a9f ==============================
18:56:28.751280 [info ] [MainThread]: Running with dbt=1.1.1
18:56:28.751772 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:56:28.751885 [debug] [MainThread]: Tracking: tracking
18:56:28.778803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce9898c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce9898cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce9898970>]}
18:56:28.800245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:56:28.800431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:56:28.804267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fcf76f7-e5cc-4cd8-9e8b-bce1eca58a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce97bbc10>]}
18:56:28.807081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fcf76f7-e5cc-4cd8-9e8b-bce1eca58a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce9851310>]}
18:56:28.807302 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:56:28.807510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fcf76f7-e5cc-4cd8-9e8b-bce1eca58a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce98514f0>]}
18:56:28.808512 [info ] [MainThread]: 
18:56:28.808925 [debug] [MainThread]: Acquiring new postgres connection "master"
18:56:28.809648 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
18:56:28.816299 [debug] [ThreadPool]: Using postgres connection "list_trial"
18:56:28.816496 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
18:56:28.816614 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:56:28.826651 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:56:28.827636 [debug] [ThreadPool]: On list_trial: Close
18:56:28.828625 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
18:56:28.832638 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:56:28.832805 [debug] [ThreadPool]: On list_trial_trial: BEGIN
18:56:28.832902 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:56:28.839534 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:56:28.839713 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:56:28.839815 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
18:56:28.841157 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
18:56:28.841880 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
18:56:28.842059 [debug] [ThreadPool]: On list_trial_trial: Close
18:56:28.844919 [debug] [MainThread]: Using postgres connection "master"
18:56:28.845078 [debug] [MainThread]: On master: BEGIN
18:56:28.845178 [debug] [MainThread]: Opening a new connection, currently in state init
18:56:28.850584 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:56:28.850926 [debug] [MainThread]: Using postgres connection "master"
18:56:28.851045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:56:28.859125 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
18:56:28.860356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fcf76f7-e5cc-4cd8-9e8b-bce1eca58a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce8f868b0>]}
18:56:28.860588 [debug] [MainThread]: On master: ROLLBACK
18:56:28.860754 [debug] [MainThread]: Using postgres connection "master"
18:56:28.860854 [debug] [MainThread]: On master: BEGIN
18:56:28.861027 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:56:28.861128 [debug] [MainThread]: On master: COMMIT
18:56:28.861217 [debug] [MainThread]: Using postgres connection "master"
18:56:28.861308 [debug] [MainThread]: On master: COMMIT
18:56:28.861427 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:56:28.861529 [debug] [MainThread]: On master: Close
18:56:28.861891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:56:28.862156 [info ] [MainThread]: 
18:56:28.864233 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
18:56:28.864462 [info ] [Thread-1  ]: 1 of 3 START table model trial.my_first_dbt_model .............................. [RUN]
18:56:28.864887 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
18:56:28.865093 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
18:56:28.865350 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
18:56:28.866951 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
18:56:28.867207 [debug] [Thread-1  ]: finished collecting timing info
18:56:28.867337 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
18:56:28.884932 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
18:56:28.885272 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:56:28.885408 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
18:56:28.885505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:28.890902 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:56:28.891148 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:56:28.891300 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:56:28.892641 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:56:28.897197 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:56:28.897347 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:56:28.897722 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:56:28.899589 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:56:28.899710 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:56:28.899944 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:56:28.906661 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:56:28.906840 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:56:28.906940 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:56:28.908226 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:56:28.911124 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:56:28.911313 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
18:56:28.913507 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:56:28.914421 [debug] [Thread-1  ]: finished collecting timing info
18:56:28.914555 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
18:56:28.914937 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fcf76f7-e5cc-4cd8-9e8b-bce1eca58a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce8746e20>]}
18:56:28.915201 [info ] [Thread-1  ]: 1 of 3 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.05s]
18:56:28.915522 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
18:56:28.915671 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
18:56:28.916038 [info ] [Thread-1  ]: 2 of 3 START view model trial.traffic_dbt_model ................................ [RUN]
18:56:28.916476 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
18:56:28.916635 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
18:56:28.916745 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
18:56:28.918310 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
18:56:28.918556 [debug] [Thread-1  ]: finished collecting timing info
18:56:28.918691 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
18:56:28.929295 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
18:56:28.929907 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:56:28.930057 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
18:56:28.930160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:28.935472 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:56:28.935621 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:56:28.935729 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:56:28.936005 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "source_data" does not exist
LINE 23: from source_data
              ^

18:56:28.936118 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: ROLLBACK
18:56:28.936342 [debug] [Thread-1  ]: finished collecting timing info
18:56:28.936449 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
18:56:28.936738 [debug] [Thread-1  ]: Database Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)
  relation "source_data" does not exist
  LINE 23: from source_data
                ^
  compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
18:56:28.936921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fcf76f7-e5cc-4cd8-9e8b-bce1eca58a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce8f78a60>]}
18:56:28.937154 [error] [Thread-1  ]: 2 of 3 ERROR creating view model trial.traffic_dbt_model ....................... [[31mERROR[0m in 0.02s]
18:56:28.937442 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
18:56:28.937571 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
18:56:28.937897 [info ] [Thread-1  ]: 3 of 3 START view model trial.my_second_dbt_model .............................. [RUN]
18:56:28.938280 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
18:56:28.938397 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
18:56:28.938558 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
18:56:28.940133 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
18:56:28.940373 [debug] [Thread-1  ]: finished collecting timing info
18:56:28.940490 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
18:56:28.941834 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
18:56:28.942111 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:56:28.942239 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
18:56:28.942332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:56:28.948072 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:56:28.948245 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:56:28.948346 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
18:56:28.949249 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:56:28.950750 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:56:28.950875 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:56:28.951139 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:56:28.951900 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:56:28.952010 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:56:28.952092 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:56:28.953250 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:56:28.954204 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:56:28.954382 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
18:56:28.954545 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:56:28.955101 [debug] [Thread-1  ]: finished collecting timing info
18:56:28.955217 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
18:56:28.955531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fcf76f7-e5cc-4cd8-9e8b-bce1eca58a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce8746b80>]}
18:56:28.955755 [info ] [Thread-1  ]: 3 of 3 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
18:56:28.956056 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
18:56:28.956854 [debug] [MainThread]: Acquiring new postgres connection "master"
18:56:28.957001 [debug] [MainThread]: Using postgres connection "master"
18:56:28.957107 [debug] [MainThread]: On master: BEGIN
18:56:28.957197 [debug] [MainThread]: Opening a new connection, currently in state closed
18:56:28.962375 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:56:28.962560 [debug] [MainThread]: On master: COMMIT
18:56:28.962677 [debug] [MainThread]: Using postgres connection "master"
18:56:28.962772 [debug] [MainThread]: On master: COMMIT
18:56:28.962952 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:56:28.963068 [debug] [MainThread]: On master: Close
18:56:28.963440 [info ] [MainThread]: 
18:56:28.963658 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.15s.
18:56:28.963844 [debug] [MainThread]: Connection 'master' was properly closed.
18:56:28.963934 [debug] [MainThread]: Connection 'list_trial' was properly closed.
18:56:28.964053 [debug] [MainThread]: Connection 'model.datawarehouse.my_second_dbt_model' was properly closed.
18:56:28.966799 [info ] [MainThread]: 
18:56:28.967046 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:56:28.967355 [info ] [MainThread]: 
18:56:28.967682 [error] [MainThread]: [33mDatabase Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)[0m
18:56:28.967928 [error] [MainThread]:   relation "source_data" does not exist
18:56:28.968151 [error] [MainThread]:   LINE 23: from source_data
18:56:28.968344 [error] [MainThread]:                 ^
18:56:28.968528 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
18:56:28.968766 [info ] [MainThread]: 
18:56:28.969063 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
18:56:28.969339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce98b8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce9851490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce9851280>]}


============================== 2022-07-23 19:13:52.438190 | 795f8687-fa53-4ab5-bd8e-9d9b955bc58e ==============================
19:13:52.438202 [info ] [MainThread]: Running with dbt=1.1.1
19:13:52.438607 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:13:52.438729 [debug] [MainThread]: Tracking: tracking
19:13:52.452814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb131448ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb131448d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb131448d60>]}
19:13:52.475126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:13:52.475444 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_dbt_model.sql
19:13:52.484739 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_dbt_model.sql
19:13:52.501975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '795f8687-fa53-4ab5-bd8e-9d9b955bc58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1302fd910>]}
19:13:52.504591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '795f8687-fa53-4ab5-bd8e-9d9b955bc58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1313d0d60>]}
19:13:52.504810 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:13:52.505017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '795f8687-fa53-4ab5-bd8e-9d9b955bc58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1313d00a0>]}
19:13:52.505962 [info ] [MainThread]: 
19:13:52.506380 [debug] [MainThread]: Acquiring new postgres connection "master"
19:13:52.507125 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
19:13:52.513103 [debug] [ThreadPool]: Using postgres connection "list_trial"
19:13:52.513218 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
19:13:52.513333 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:13:52.519632 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:13:52.520675 [debug] [ThreadPool]: On list_trial: Close
19:13:52.521708 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
19:13:52.525772 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:13:52.526056 [debug] [ThreadPool]: On list_trial_trial: BEGIN
19:13:52.526236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:13:52.531537 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:13:52.531684 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:13:52.531795 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
19:13:52.533180 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
19:13:52.533931 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
19:13:52.534245 [debug] [ThreadPool]: On list_trial_trial: Close
19:13:52.537648 [debug] [MainThread]: Using postgres connection "master"
19:13:52.537810 [debug] [MainThread]: On master: BEGIN
19:13:52.537920 [debug] [MainThread]: Opening a new connection, currently in state init
19:13:52.543571 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:13:52.543746 [debug] [MainThread]: Using postgres connection "master"
19:13:52.543845 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:13:52.552567 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
19:13:52.554055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '795f8687-fa53-4ab5-bd8e-9d9b955bc58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1302fda90>]}
19:13:52.554479 [debug] [MainThread]: On master: ROLLBACK
19:13:52.554901 [debug] [MainThread]: Using postgres connection "master"
19:13:52.555117 [debug] [MainThread]: On master: BEGIN
19:13:52.555388 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:13:52.555581 [debug] [MainThread]: On master: COMMIT
19:13:52.555745 [debug] [MainThread]: Using postgres connection "master"
19:13:52.555917 [debug] [MainThread]: On master: COMMIT
19:13:52.556147 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:13:52.556266 [debug] [MainThread]: On master: Close
19:13:52.556628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:13:52.556841 [info ] [MainThread]: 
19:13:52.559623 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
19:13:52.559917 [info ] [Thread-1  ]: 1 of 3 START table model trial.my_first_dbt_model .............................. [RUN]
19:13:52.560390 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
19:13:52.560562 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
19:13:52.560683 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
19:13:52.562234 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
19:13:52.562499 [debug] [Thread-1  ]: finished collecting timing info
19:13:52.562629 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
19:13:52.579363 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
19:13:52.579714 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:13:52.579847 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
19:13:52.579936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:13:52.585260 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:13:52.585428 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:13:52.585535 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:13:52.586477 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
19:13:52.590563 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:13:52.590814 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:13:52.591249 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:13:52.593149 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:13:52.593285 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:13:52.593537 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:13:52.601164 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:13:52.601335 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:13:52.601475 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:13:52.602757 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:13:52.605821 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:13:52.605978 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
19:13:52.608137 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:13:52.609694 [debug] [Thread-1  ]: finished collecting timing info
19:13:52.609857 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
19:13:52.610292 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795f8687-fa53-4ab5-bd8e-9d9b955bc58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1302c3700>]}
19:13:52.610606 [info ] [Thread-1  ]: 1 of 3 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.05s]
19:13:52.610948 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
19:13:52.611148 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
19:13:52.611417 [info ] [Thread-1  ]: 2 of 3 START view model trial.traffic_dbt_model ................................ [RUN]
19:13:52.611991 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
19:13:52.612181 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
19:13:52.612313 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
19:13:52.613876 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
19:13:52.614137 [debug] [Thread-1  ]: finished collecting timing info
19:13:52.614276 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
19:13:52.625749 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
19:13:52.626127 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:13:52.626266 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
19:13:52.626363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:13:52.632070 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:13:52.632247 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:13:52.632350 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:13:52.632615 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "traffic_dbt_model" does not exist
LINE 23: from traffic_dbt_model
              ^

19:13:52.632733 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: ROLLBACK
19:13:52.632963 [debug] [Thread-1  ]: finished collecting timing info
19:13:52.633079 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
19:13:52.633404 [debug] [Thread-1  ]: Database Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)
  relation "traffic_dbt_model" does not exist
  LINE 23: from traffic_dbt_model
                ^
  compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
19:13:52.633611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795f8687-fa53-4ab5-bd8e-9d9b955bc58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb130290df0>]}
19:13:52.633871 [error] [Thread-1  ]: 2 of 3 ERROR creating view model trial.traffic_dbt_model ....................... [[31mERROR[0m in 0.02s]
19:13:52.634204 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
19:13:52.634365 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
19:13:52.634743 [info ] [Thread-1  ]: 3 of 3 START view model trial.my_second_dbt_model .............................. [RUN]
19:13:52.635459 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
19:13:52.635630 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
19:13:52.635737 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
19:13:52.637355 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
19:13:52.637608 [debug] [Thread-1  ]: finished collecting timing info
19:13:52.637729 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
19:13:52.639046 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
19:13:52.639256 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:13:52.639364 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
19:13:52.639466 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:13:52.645498 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:13:52.645722 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:13:52.645831 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
19:13:52.646950 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:13:52.648557 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:13:52.648702 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:13:52.648978 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:13:52.649768 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:13:52.649891 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:13:52.649981 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:13:52.651060 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:13:52.652178 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:13:52.652298 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
19:13:52.652511 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:13:52.653233 [debug] [Thread-1  ]: finished collecting timing info
19:13:52.653359 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
19:13:52.653814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795f8687-fa53-4ab5-bd8e-9d9b955bc58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb130333070>]}
19:13:52.654206 [info ] [Thread-1  ]: 3 of 3 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
19:13:52.654611 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
19:13:52.655484 [debug] [MainThread]: Acquiring new postgres connection "master"
19:13:52.655627 [debug] [MainThread]: Using postgres connection "master"
19:13:52.655724 [debug] [MainThread]: On master: BEGIN
19:13:52.655814 [debug] [MainThread]: Opening a new connection, currently in state closed
19:13:52.660847 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:13:52.661032 [debug] [MainThread]: On master: COMMIT
19:13:52.661134 [debug] [MainThread]: Using postgres connection "master"
19:13:52.661228 [debug] [MainThread]: On master: COMMIT
19:13:52.661363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:13:52.661507 [debug] [MainThread]: On master: Close
19:13:52.661902 [info ] [MainThread]: 
19:13:52.662142 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.16s.
19:13:52.662378 [debug] [MainThread]: Connection 'master' was properly closed.
19:13:52.662541 [debug] [MainThread]: Connection 'model.datawarehouse.my_second_dbt_model' was properly closed.
19:13:52.665470 [info ] [MainThread]: 
19:13:52.665748 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:13:52.665960 [info ] [MainThread]: 
19:13:52.666186 [error] [MainThread]: [33mDatabase Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)[0m
19:13:52.666513 [error] [MainThread]:   relation "traffic_dbt_model" does not exist
19:13:52.666687 [error] [MainThread]:   LINE 23: from traffic_dbt_model
19:13:52.666896 [error] [MainThread]:                 ^
19:13:52.667141 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
19:13:52.667351 [info ] [MainThread]: 
19:13:52.667818 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
19:13:52.668310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb131369be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1313d00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1313d0c10>]}


============================== 2022-07-23 19:15:00.145322 | e16e0256-69e4-40d8-a174-ae503d22c7b6 ==============================
19:15:00.145335 [info ] [MainThread]: Running with dbt=1.1.1
19:15:00.145781 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:15:00.145906 [debug] [MainThread]: Tracking: tracking
19:15:00.160857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1134dd1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1134dd1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1134dd1dc0>]}
19:15:00.178052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:15:00.178244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:15:00.182261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e16e0256-69e4-40d8-a174-ae503d22c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1134cf3d00>]}
19:15:00.184912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e16e0256-69e4-40d8-a174-ae503d22c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1134d89400>]}
19:15:00.185120 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:15:00.185306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e16e0256-69e4-40d8-a174-ae503d22c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1134d895e0>]}
19:15:00.186296 [info ] [MainThread]: 
19:15:00.186680 [debug] [MainThread]: Acquiring new postgres connection "master"
19:15:00.187416 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
19:15:00.194365 [debug] [ThreadPool]: Using postgres connection "list_trial"
19:15:00.194584 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
19:15:00.194789 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:15:00.215287 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.02 seconds
19:15:00.216426 [debug] [ThreadPool]: On list_trial: Close
19:15:00.217916 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
19:15:00.224186 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:15:00.224519 [debug] [ThreadPool]: On list_trial_trial: BEGIN
19:15:00.224711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:15:00.231268 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:15:00.231506 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:15:00.231614 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
19:15:00.233031 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
19:15:00.233819 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
19:15:00.234059 [debug] [ThreadPool]: On list_trial_trial: Close
19:15:00.237119 [debug] [MainThread]: Using postgres connection "master"
19:15:00.237283 [debug] [MainThread]: On master: BEGIN
19:15:00.237391 [debug] [MainThread]: Opening a new connection, currently in state init
19:15:00.243084 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:15:00.243462 [debug] [MainThread]: Using postgres connection "master"
19:15:00.243643 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:15:00.253629 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
19:15:00.255248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e16e0256-69e4-40d8-a174-ae503d22c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1134df9100>]}
19:15:00.255567 [debug] [MainThread]: On master: ROLLBACK
19:15:00.255828 [debug] [MainThread]: Using postgres connection "master"
19:15:00.255937 [debug] [MainThread]: On master: BEGIN
19:15:00.256124 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:15:00.256295 [debug] [MainThread]: On master: COMMIT
19:15:00.256451 [debug] [MainThread]: Using postgres connection "master"
19:15:00.256596 [debug] [MainThread]: On master: COMMIT
19:15:00.256835 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:15:00.256977 [debug] [MainThread]: On master: Close
19:15:00.257528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:15:00.257925 [info ] [MainThread]: 
19:15:00.260455 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
19:15:00.260876 [info ] [Thread-1  ]: 1 of 3 START table model trial.my_first_dbt_model .............................. [RUN]
19:15:00.261476 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
19:15:00.261615 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
19:15:00.261967 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
19:15:00.263792 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
19:15:00.264051 [debug] [Thread-1  ]: finished collecting timing info
19:15:00.264179 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
19:15:00.282415 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
19:15:00.282806 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:15:00.282950 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
19:15:00.283046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:15:00.288951 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:15:00.289149 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:15:00.289253 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:15:00.290111 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
19:15:00.293973 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:15:00.294123 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:15:00.294600 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:15:00.297661 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:15:00.297836 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:15:00.298407 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:15:00.308731 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:15:00.309069 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:15:00.309254 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:15:00.310548 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:15:00.321128 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:15:00.321411 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
19:15:00.323360 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:15:00.324197 [debug] [Thread-1  ]: finished collecting timing info
19:15:00.324356 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
19:15:00.324782 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e16e0256-69e4-40d8-a174-ae503d22c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f113447fee0>]}
19:15:00.325076 [info ] [Thread-1  ]: 1 of 3 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.06s]
19:15:00.325448 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
19:15:00.325642 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
19:15:00.326148 [info ] [Thread-1  ]: 2 of 3 START view model trial.traffic_dbt_model ................................ [RUN]
19:15:00.327018 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
19:15:00.327217 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
19:15:00.327385 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
19:15:00.329972 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
19:15:00.330363 [debug] [Thread-1  ]: finished collecting timing info
19:15:00.330559 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
19:15:00.344227 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
19:15:00.344555 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:15:00.344683 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
19:15:00.344778 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:15:00.351268 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:15:00.351534 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:15:00.351652 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:15:00.352001 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "traffic_dbt_model" does not exist
LINE 23: from traffic_dbt_model
              ^

19:15:00.352155 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: ROLLBACK
19:15:00.352416 [debug] [Thread-1  ]: finished collecting timing info
19:15:00.352546 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
19:15:00.352910 [debug] [Thread-1  ]: Database Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)
  relation "traffic_dbt_model" does not exist
  LINE 23: from traffic_dbt_model
                ^
  compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
19:15:00.353123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e16e0256-69e4-40d8-a174-ae503d22c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11344bed60>]}
19:15:00.353394 [error] [Thread-1  ]: 2 of 3 ERROR creating view model trial.traffic_dbt_model ....................... [[31mERROR[0m in 0.03s]
19:15:00.353727 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
19:15:00.353861 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
19:15:00.354194 [info ] [Thread-1  ]: 3 of 3 START view model trial.my_second_dbt_model .............................. [RUN]
19:15:00.354626 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
19:15:00.354779 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
19:15:00.354920 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
19:15:00.356490 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
19:15:00.356726 [debug] [Thread-1  ]: finished collecting timing info
19:15:00.356843 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
19:15:00.358156 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
19:15:00.358370 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:15:00.358496 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
19:15:00.358586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:15:00.364463 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:15:00.364676 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:15:00.364785 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
19:15:00.365769 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:15:00.367435 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:15:00.367584 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:15:00.368138 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:15:00.369418 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:15:00.369562 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:15:00.369662 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:15:00.370761 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:15:00.371802 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:15:00.372006 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
19:15:00.372252 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:15:00.373028 [debug] [Thread-1  ]: finished collecting timing info
19:15:00.373187 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
19:15:00.373580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e16e0256-69e4-40d8-a174-ae503d22c7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11344bebb0>]}
19:15:00.373845 [info ] [Thread-1  ]: 3 of 3 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
19:15:00.374165 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
19:15:00.375093 [debug] [MainThread]: Acquiring new postgres connection "master"
19:15:00.375292 [debug] [MainThread]: Using postgres connection "master"
19:15:00.375398 [debug] [MainThread]: On master: BEGIN
19:15:00.375491 [debug] [MainThread]: Opening a new connection, currently in state closed
19:15:00.381837 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:15:00.382216 [debug] [MainThread]: On master: COMMIT
19:15:00.382387 [debug] [MainThread]: Using postgres connection "master"
19:15:00.382542 [debug] [MainThread]: On master: COMMIT
19:15:00.382799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:15:00.382926 [debug] [MainThread]: On master: Close
19:15:00.383349 [info ] [MainThread]: 
19:15:00.383579 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.20s.
19:15:00.383788 [debug] [MainThread]: Connection 'master' was properly closed.
19:15:00.383939 [debug] [MainThread]: Connection 'model.datawarehouse.my_second_dbt_model' was properly closed.
19:15:00.386866 [info ] [MainThread]: 
19:15:00.387226 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:15:00.387502 [info ] [MainThread]: 
19:15:00.387781 [error] [MainThread]: [33mDatabase Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)[0m
19:15:00.388028 [error] [MainThread]:   relation "traffic_dbt_model" does not exist
19:15:00.388262 [error] [MainThread]:   LINE 23: from traffic_dbt_model
19:15:00.388483 [error] [MainThread]:                 ^
19:15:00.388704 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
19:15:00.388956 [info ] [MainThread]: 
19:15:00.389194 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
19:15:00.389510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1134de89a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1134d895b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11344d8dc0>]}


============================== 2022-07-23 19:17:59.879857 | 83a3ce9d-c42f-47e3-9956-371cf4cf0e29 ==============================
19:17:59.879869 [info ] [MainThread]: Running with dbt=1.1.1
19:17:59.880231 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:17:59.880360 [debug] [MainThread]: Tracking: tracking
19:17:59.895882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003b997be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003b997cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003b997ca0>]}
19:17:59.916211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:17:59.916590 [debug] [MainThread]: Partial parsing: update schema file: datawarehouse://models/example/schema.yml
19:17:59.925165 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_dbt_model.sql
19:17:59.943278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83a3ce9d-c42f-47e3-9956-371cf4cf0e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003a84d760>]}
19:17:59.946002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83a3ce9d-c42f-47e3-9956-371cf4cf0e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003b91fd90>]}
19:17:59.946235 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:17:59.946430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83a3ce9d-c42f-47e3-9956-371cf4cf0e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003b91ff40>]}
19:17:59.947425 [info ] [MainThread]: 
19:17:59.947798 [debug] [MainThread]: Acquiring new postgres connection "master"
19:17:59.948529 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
19:17:59.955914 [debug] [ThreadPool]: Using postgres connection "list_trial"
19:17:59.956267 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
19:17:59.956480 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:17:59.966267 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:17:59.967835 [debug] [ThreadPool]: On list_trial: Close
19:17:59.971408 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
19:17:59.977329 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:17:59.977581 [debug] [ThreadPool]: On list_trial_trial: BEGIN
19:17:59.977693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:17:59.984302 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:17:59.984495 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:17:59.984601 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
19:17:59.985971 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
19:17:59.986898 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
19:17:59.987187 [debug] [ThreadPool]: On list_trial_trial: Close
19:17:59.990795 [debug] [MainThread]: Using postgres connection "master"
19:17:59.990991 [debug] [MainThread]: On master: BEGIN
19:17:59.991190 [debug] [MainThread]: Opening a new connection, currently in state init
19:17:59.998882 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:17:59.999195 [debug] [MainThread]: Using postgres connection "master"
19:17:59.999357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:18:00.008701 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
19:18:00.009665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83a3ce9d-c42f-47e3-9956-371cf4cf0e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003a84d8b0>]}
19:18:00.009932 [debug] [MainThread]: On master: ROLLBACK
19:18:00.010130 [debug] [MainThread]: Using postgres connection "master"
19:18:00.010259 [debug] [MainThread]: On master: BEGIN
19:18:00.010485 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:18:00.010597 [debug] [MainThread]: On master: COMMIT
19:18:00.010695 [debug] [MainThread]: Using postgres connection "master"
19:18:00.010787 [debug] [MainThread]: On master: COMMIT
19:18:00.010930 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:18:00.011037 [debug] [MainThread]: On master: Close
19:18:00.011463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:18:00.011684 [info ] [MainThread]: 
19:18:00.013910 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
19:18:00.014165 [info ] [Thread-1  ]: 1 of 3 START table model trial.my_first_dbt_model .............................. [RUN]
19:18:00.014592 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:00.014749 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
19:18:00.014878 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
19:18:00.016475 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
19:18:00.016713 [debug] [Thread-1  ]: finished collecting timing info
19:18:00.016836 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
19:18:00.034144 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
19:18:00.034523 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:00.034647 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
19:18:00.034740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:18:00.040192 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:18:00.040502 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:00.040712 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:18:00.041872 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
19:18:00.047225 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:00.047425 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:18:00.047836 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:18:00.049331 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:00.049452 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:18:00.049674 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:18:00.056574 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:18:00.056726 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:00.056838 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:18:00.057948 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:18:00.061436 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:00.061610 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
19:18:00.063416 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:18:00.064205 [debug] [Thread-1  ]: finished collecting timing info
19:18:00.064345 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
19:18:00.064716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83a3ce9d-c42f-47e3-9956-371cf4cf0e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003a011f10>]}
19:18:00.064976 [info ] [Thread-1  ]: 1 of 3 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.05s]
19:18:00.065276 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
19:18:00.065402 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
19:18:00.065786 [info ] [Thread-1  ]: 2 of 3 START view model trial.traffic_dbt_model ................................ [RUN]
19:18:00.066197 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
19:18:00.066354 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
19:18:00.066460 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
19:18:00.068097 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
19:18:00.068432 [debug] [Thread-1  ]: finished collecting timing info
19:18:00.068619 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
19:18:00.080524 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
19:18:00.080859 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:18:00.080977 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
19:18:00.081067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:18:00.086638 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:18:00.086865 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:18:00.086980 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:18:00.087454 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "traffic_dbt_model" does not exist
LINE 23: from traffic_dbt_model
              ^

19:18:00.087760 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: ROLLBACK
19:18:00.088230 [debug] [Thread-1  ]: finished collecting timing info
19:18:00.088461 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
19:18:00.088914 [debug] [Thread-1  ]: Database Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)
  relation "traffic_dbt_model" does not exist
  LINE 23: from traffic_dbt_model
                ^
  compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
19:18:00.089192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83a3ce9d-c42f-47e3-9956-371cf4cf0e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003878d070>]}
19:18:00.089530 [error] [Thread-1  ]: 2 of 3 ERROR creating view model trial.traffic_dbt_model ....................... [[31mERROR[0m in 0.02s]
19:18:00.089902 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
19:18:00.090072 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
19:18:00.090460 [info ] [Thread-1  ]: 3 of 3 START view model trial.my_second_dbt_model .............................. [RUN]
19:18:00.090918 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:00.091066 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
19:18:00.091234 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
19:18:00.093639 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
19:18:00.093908 [debug] [Thread-1  ]: finished collecting timing info
19:18:00.094027 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
19:18:00.095292 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
19:18:00.095508 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:00.095614 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
19:18:00.095706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:18:00.100709 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:18:00.100851 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:00.100945 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
19:18:00.101865 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:18:00.104246 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:00.104455 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:18:00.104914 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:18:00.105798 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:18:00.105924 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:00.106013 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:18:00.107035 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:18:00.108191 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:00.108316 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
19:18:00.108549 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:18:00.109231 [debug] [Thread-1  ]: finished collecting timing info
19:18:00.109363 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
19:18:00.109741 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83a3ce9d-c42f-47e3-9956-371cf4cf0e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0039ffc220>]}
19:18:00.109997 [info ] [Thread-1  ]: 3 of 3 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
19:18:00.110299 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
19:18:00.111158 [debug] [MainThread]: Acquiring new postgres connection "master"
19:18:00.111311 [debug] [MainThread]: Using postgres connection "master"
19:18:00.111417 [debug] [MainThread]: On master: BEGIN
19:18:00.111506 [debug] [MainThread]: Opening a new connection, currently in state closed
19:18:00.116467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:18:00.116635 [debug] [MainThread]: On master: COMMIT
19:18:00.116736 [debug] [MainThread]: Using postgres connection "master"
19:18:00.116827 [debug] [MainThread]: On master: COMMIT
19:18:00.116962 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:18:00.117069 [debug] [MainThread]: On master: Close
19:18:00.117421 [info ] [MainThread]: 
19:18:00.117644 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.17s.
19:18:00.117883 [debug] [MainThread]: Connection 'master' was properly closed.
19:18:00.118014 [debug] [MainThread]: Connection 'model.datawarehouse.my_second_dbt_model' was properly closed.
19:18:00.121927 [info ] [MainThread]: 
19:18:00.122222 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:18:00.122595 [info ] [MainThread]: 
19:18:00.122898 [error] [MainThread]: [33mDatabase Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)[0m
19:18:00.123215 [error] [MainThread]:   relation "traffic_dbt_model" does not exist
19:18:00.123505 [error] [MainThread]:   LINE 23: from traffic_dbt_model
19:18:00.123802 [error] [MainThread]:                 ^
19:18:00.124121 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
19:18:00.124346 [info ] [MainThread]: 
19:18:00.124606 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
19:18:00.124914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003b8c1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003b91ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003b91ff70>]}


============================== 2022-07-23 19:18:30.858475 | ccef13e2-0c9f-456b-8532-3ef6727bccbd ==============================
19:18:30.858488 [info ] [MainThread]: Running with dbt=1.1.1
19:18:30.858958 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:18:30.859073 [debug] [MainThread]: Tracking: tracking
19:18:30.876398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049b834b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049b834c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049b834be0>]}
19:18:30.897864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
19:18:30.898311 [debug] [MainThread]: Partial parsing: update schema file: datawarehouse://models/example/schema.yml
19:18:30.898479 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_dbt_model.sql
19:18:30.906613 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_dbt_model.sql
19:18:30.919789 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'datasets' in the 'models' section of file 'models/example/schema.yml'
19:18:30.924881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccef13e2-0c9f-456b-8532-3ef6727bccbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049a6e27f0>]}
19:18:30.927679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccef13e2-0c9f-456b-8532-3ef6727bccbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049b868580>]}
19:18:30.927889 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:18:30.928094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccef13e2-0c9f-456b-8532-3ef6727bccbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049b868820>]}
19:18:30.929038 [info ] [MainThread]: 
19:18:30.929423 [debug] [MainThread]: Acquiring new postgres connection "master"
19:18:30.930130 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
19:18:30.935904 [debug] [ThreadPool]: Using postgres connection "list_trial"
19:18:30.936024 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
19:18:30.936115 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:18:30.944536 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:18:30.945571 [debug] [ThreadPool]: On list_trial: Close
19:18:30.946703 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
19:18:30.952174 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:18:30.952473 [debug] [ThreadPool]: On list_trial_trial: BEGIN
19:18:30.952640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:18:30.967475 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:18:30.967830 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:18:30.968125 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
19:18:30.970350 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
19:18:30.971735 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
19:18:30.972128 [debug] [ThreadPool]: On list_trial_trial: Close
19:18:30.975904 [debug] [MainThread]: Using postgres connection "master"
19:18:30.976086 [debug] [MainThread]: On master: BEGIN
19:18:30.976200 [debug] [MainThread]: Opening a new connection, currently in state init
19:18:30.981391 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:18:30.981617 [debug] [MainThread]: Using postgres connection "master"
19:18:30.981799 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:18:30.993559 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
19:18:30.995082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccef13e2-0c9f-456b-8532-3ef6727bccbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049b868280>]}
19:18:30.995497 [debug] [MainThread]: On master: ROLLBACK
19:18:30.995870 [debug] [MainThread]: Using postgres connection "master"
19:18:30.996052 [debug] [MainThread]: On master: BEGIN
19:18:30.996387 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:18:30.996566 [debug] [MainThread]: On master: COMMIT
19:18:30.996714 [debug] [MainThread]: Using postgres connection "master"
19:18:30.996858 [debug] [MainThread]: On master: COMMIT
19:18:30.997097 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:18:30.997267 [debug] [MainThread]: On master: Close
19:18:30.997813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:18:30.998149 [info ] [MainThread]: 
19:18:31.000744 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
19:18:31.001101 [info ] [Thread-1  ]: 1 of 3 START table model trial.my_first_dbt_model .............................. [RUN]
19:18:31.001705 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:31.001880 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
19:18:31.002056 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
19:18:31.003819 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
19:18:31.004065 [debug] [Thread-1  ]: finished collecting timing info
19:18:31.004188 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
19:18:31.019798 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
19:18:31.020141 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:31.020260 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
19:18:31.020352 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:18:31.026303 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:18:31.026513 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:31.026619 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:18:31.027556 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
19:18:31.032305 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:31.032466 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:18:31.032962 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:18:31.034388 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:31.034533 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:18:31.034859 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:18:31.042939 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:18:31.043110 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:31.043195 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:18:31.044810 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:18:31.047787 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:18:31.048035 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
19:18:31.050389 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:18:31.051311 [debug] [Thread-1  ]: finished collecting timing info
19:18:31.051524 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
19:18:31.052125 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccef13e2-0c9f-456b-8532-3ef6727bccbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0499ea6f70>]}
19:18:31.052563 [info ] [Thread-1  ]: 1 of 3 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.05s]
19:18:31.053118 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
19:18:31.053382 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
19:18:31.053816 [info ] [Thread-1  ]: 2 of 3 START view model trial.traffic_dbt_model ................................ [RUN]
19:18:31.054449 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
19:18:31.054652 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
19:18:31.054828 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
19:18:31.057404 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
19:18:31.057790 [debug] [Thread-1  ]: finished collecting timing info
19:18:31.057984 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
19:18:31.069539 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
19:18:31.070024 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:18:31.070256 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
19:18:31.070416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:18:31.076994 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:18:31.077315 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:18:31.077449 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- with source_data as (

--     select 1 as id
--     union all
--     select null as id

-- )

select *
from datasets

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:18:31.078653 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:18:31.080203 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:18:31.080319 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model__dbt_tmp" rename to "traffic_dbt_model"
19:18:31.080604 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:18:31.081382 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
19:18:31.081493 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:18:31.081587 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
19:18:31.083277 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:18:31.084419 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:18:31.084534 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
drop view if exists "trial"."trial"."traffic_dbt_model__dbt_backup" cascade
19:18:31.084850 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:18:31.085868 [debug] [Thread-1  ]: finished collecting timing info
19:18:31.086063 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
19:18:31.086519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccef13e2-0c9f-456b-8532-3ef6727bccbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0499e8c3a0>]}
19:18:31.086790 [info ] [Thread-1  ]: 2 of 3 OK created view model trial.traffic_dbt_model ........................... [[32mCREATE VIEW[0m in 0.03s]
19:18:31.087081 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
19:18:31.087229 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
19:18:31.087600 [info ] [Thread-1  ]: 3 of 3 START view model trial.my_second_dbt_model .............................. [RUN]
19:18:31.088065 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:31.088260 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
19:18:31.088383 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
19:18:31.090162 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
19:18:31.090415 [debug] [Thread-1  ]: finished collecting timing info
19:18:31.090533 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
19:18:31.091894 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
19:18:31.092116 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:31.092222 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
19:18:31.092322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:18:31.098785 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:18:31.099003 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:31.099107 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
19:18:31.100262 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:18:31.102063 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:31.102242 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:18:31.102685 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:18:31.103543 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:18:31.103664 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:31.103755 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:18:31.105055 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:18:31.106274 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:18:31.106410 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
19:18:31.106683 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:18:31.107384 [debug] [Thread-1  ]: finished collecting timing info
19:18:31.107514 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
19:18:31.107981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccef13e2-0c9f-456b-8532-3ef6727bccbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0499e8c220>]}
19:18:31.108341 [info ] [Thread-1  ]: 3 of 3 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
19:18:31.108770 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
19:18:31.110196 [debug] [MainThread]: Acquiring new postgres connection "master"
19:18:31.110415 [debug] [MainThread]: Using postgres connection "master"
19:18:31.110528 [debug] [MainThread]: On master: BEGIN
19:18:31.110634 [debug] [MainThread]: Opening a new connection, currently in state closed
19:18:31.115891 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:18:31.116048 [debug] [MainThread]: On master: COMMIT
19:18:31.116157 [debug] [MainThread]: Using postgres connection "master"
19:18:31.116250 [debug] [MainThread]: On master: COMMIT
19:18:31.116380 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:18:31.116488 [debug] [MainThread]: On master: Close
19:18:31.116845 [info ] [MainThread]: 
19:18:31.118640 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.19s.
19:18:31.118934 [debug] [MainThread]: Connection 'master' was properly closed.
19:18:31.119037 [debug] [MainThread]: Connection 'model.datawarehouse.my_second_dbt_model' was properly closed.
19:18:31.121770 [info ] [MainThread]: 
19:18:31.122055 [info ] [MainThread]: [32mCompleted successfully[0m
19:18:31.122303 [info ] [MainThread]: 
19:18:31.122539 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
19:18:31.122947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049b8688b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049a729790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f049b7d31f0>]}


============================== 2022-07-23 19:23:10.626729 | 095c1f01-5173-48a8-9530-0e032e361f7d ==============================
19:23:10.626740 [info ] [MainThread]: Running with dbt=1.1.1
19:23:10.627101 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:23:10.627237 [debug] [MainThread]: Tracking: tracking
19:23:10.640846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f5a2bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f5a2bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f5a2bcd0>]}
19:23:10.662897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:23:10.663211 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_dbt_model.sql
19:23:10.672610 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_dbt_model.sql
19:23:10.685402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '095c1f01-5173-48a8-9530-0e032e361f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f4b2f4c0>]}
19:23:10.688029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '095c1f01-5173-48a8-9530-0e032e361f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f5a67790>]}
19:23:10.688252 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:23:10.688458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095c1f01-5173-48a8-9530-0e032e361f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f59affd0>]}
19:23:10.689386 [info ] [MainThread]: 
19:23:10.689757 [debug] [MainThread]: Acquiring new postgres connection "master"
19:23:10.690484 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
19:23:10.697001 [debug] [ThreadPool]: Using postgres connection "list_trial"
19:23:10.697272 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
19:23:10.697464 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:23:10.707218 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:23:10.708919 [debug] [ThreadPool]: On list_trial: Close
19:23:10.716620 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
19:23:10.723943 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:23:10.724151 [debug] [ThreadPool]: On list_trial_trial: BEGIN
19:23:10.724253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:23:10.729638 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:23:10.729825 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:23:10.729933 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
19:23:10.731806 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
19:23:10.732823 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
19:23:10.733262 [debug] [ThreadPool]: On list_trial_trial: Close
19:23:10.737548 [debug] [MainThread]: Using postgres connection "master"
19:23:10.737713 [debug] [MainThread]: On master: BEGIN
19:23:10.737815 [debug] [MainThread]: Opening a new connection, currently in state init
19:23:10.744619 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:23:10.744850 [debug] [MainThread]: Using postgres connection "master"
19:23:10.744954 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:23:10.754671 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
19:23:10.755506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095c1f01-5173-48a8-9530-0e032e361f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f4ae67f0>]}
19:23:10.755728 [debug] [MainThread]: On master: ROLLBACK
19:23:10.755901 [debug] [MainThread]: Using postgres connection "master"
19:23:10.756001 [debug] [MainThread]: On master: BEGIN
19:23:10.756172 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:23:10.756269 [debug] [MainThread]: On master: COMMIT
19:23:10.756358 [debug] [MainThread]: Using postgres connection "master"
19:23:10.756448 [debug] [MainThread]: On master: COMMIT
19:23:10.756566 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:23:10.756667 [debug] [MainThread]: On master: Close
19:23:10.756994 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:23:10.757207 [info ] [MainThread]: 
19:23:10.759417 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
19:23:10.759652 [info ] [Thread-1  ]: 1 of 3 START table model trial.my_first_dbt_model .............................. [RUN]
19:23:10.760047 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:10.760197 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
19:23:10.760355 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
19:23:10.762217 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
19:23:10.762659 [debug] [Thread-1  ]: finished collecting timing info
19:23:10.762875 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
19:23:10.782930 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
19:23:10.783370 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:10.783607 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
19:23:10.783773 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:23:10.789976 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:23:10.790200 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:10.790326 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:23:10.791249 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
19:23:10.795645 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:10.795788 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:23:10.796106 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:23:10.797457 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:10.797575 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:23:10.797767 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:23:10.804991 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:23:10.805214 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:10.805332 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:23:10.806623 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:23:10.809732 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:10.809881 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
19:23:10.812130 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:23:10.813069 [debug] [Thread-1  ]: finished collecting timing info
19:23:10.813225 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
19:23:10.813607 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '095c1f01-5173-48a8-9530-0e032e361f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f4b2faf0>]}
19:23:10.813864 [info ] [Thread-1  ]: 1 of 3 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.05s]
19:23:10.814178 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
19:23:10.814312 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
19:23:10.814609 [info ] [Thread-1  ]: 2 of 3 START view model trial.traffic_dbt_model ................................ [RUN]
19:23:10.815119 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
19:23:10.815340 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
19:23:10.815560 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
19:23:10.817694 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
19:23:10.817937 [debug] [Thread-1  ]: finished collecting timing info
19:23:10.818056 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
19:23:10.827745 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
19:23:10.828027 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:23:10.828139 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
19:23:10.828231 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:23:10.834145 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:23:10.834364 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:23:10.834473 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with traffic_dbt_model as (

    select id,track_id,type from datasets

)

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:23:10.834937 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "type" does not exist
LINE 16:     select id,track_id,type from datasets
                                ^
HINT:  Perhaps you meant to reference the column "datasets. type".

19:23:10.835082 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: ROLLBACK
19:23:10.835357 [debug] [Thread-1  ]: finished collecting timing info
19:23:10.835478 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
19:23:10.835849 [debug] [Thread-1  ]: Database Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)
  column "type" does not exist
  LINE 16:     select id,track_id,type from datasets
                                  ^
  HINT:  Perhaps you meant to reference the column "datasets. type".
  compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
19:23:10.836153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '095c1f01-5173-48a8-9530-0e032e361f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f42611c0>]}
19:23:10.836448 [error] [Thread-1  ]: 2 of 3 ERROR creating view model trial.traffic_dbt_model ....................... [[31mERROR[0m in 0.02s]
19:23:10.836799 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
19:23:10.836960 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
19:23:10.837291 [info ] [Thread-1  ]: 3 of 3 START view model trial.my_second_dbt_model .............................. [RUN]
19:23:10.837871 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:10.838075 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
19:23:10.838265 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
19:23:10.840217 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
19:23:10.840465 [debug] [Thread-1  ]: finished collecting timing info
19:23:10.840689 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
19:23:10.842563 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
19:23:10.842776 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:10.842881 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
19:23:10.842971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:23:10.849109 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:23:10.849342 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:10.849457 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
19:23:10.850509 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:23:10.852279 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:10.852441 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:23:10.852891 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:23:10.853787 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:23:10.853928 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:10.854027 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:23:10.855205 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:23:10.856141 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:10.856251 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
19:23:10.856477 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:23:10.857105 [debug] [Thread-1  ]: finished collecting timing info
19:23:10.857237 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
19:23:10.857590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '095c1f01-5173-48a8-9530-0e032e361f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f4b2fe50>]}
19:23:10.857836 [info ] [Thread-1  ]: 3 of 3 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
19:23:10.858142 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
19:23:10.859009 [debug] [MainThread]: Acquiring new postgres connection "master"
19:23:10.859158 [debug] [MainThread]: Using postgres connection "master"
19:23:10.859261 [debug] [MainThread]: On master: BEGIN
19:23:10.859355 [debug] [MainThread]: Opening a new connection, currently in state closed
19:23:10.864423 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:23:10.864623 [debug] [MainThread]: On master: COMMIT
19:23:10.864773 [debug] [MainThread]: Using postgres connection "master"
19:23:10.864927 [debug] [MainThread]: On master: COMMIT
19:23:10.865230 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:23:10.865375 [debug] [MainThread]: On master: Close
19:23:10.865753 [info ] [MainThread]: 
19:23:10.865963 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.18s.
19:23:10.866154 [debug] [MainThread]: Connection 'master' was properly closed.
19:23:10.866250 [debug] [MainThread]: Connection 'model.datawarehouse.my_second_dbt_model' was properly closed.
19:23:10.869626 [info ] [MainThread]: 
19:23:10.869885 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:23:10.870084 [info ] [MainThread]: 
19:23:10.870367 [error] [MainThread]: [33mDatabase Error in model traffic_dbt_model (models/example/traffic_dbt_model.sql)[0m
19:23:10.870624 [error] [MainThread]:   column "type" does not exist
19:23:10.870883 [error] [MainThread]:   LINE 16:     select id,track_id,type from datasets
19:23:10.871264 [error] [MainThread]:                                   ^
19:23:10.871662 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "datasets. type".
19:23:10.872117 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_dbt_model.sql
19:23:10.872445 [info ] [MainThread]: 
19:23:10.872659 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
19:23:10.872941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f59aff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f5a2bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40f5a49e20>]}


============================== 2022-07-23 19:23:32.987605 | 67d40cb2-3590-47ee-ad85-64acf316503f ==============================
19:23:32.987619 [info ] [MainThread]: Running with dbt=1.1.1
19:23:32.988087 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:23:32.988207 [debug] [MainThread]: Tracking: tracking
19:23:33.005234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960099b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960099c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960099c10>]}
19:23:33.030919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:23:33.031454 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_dbt_model.sql
19:23:33.041853 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_dbt_model.sql
19:23:33.058454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67d40cb2-3590-47ee-ad85-64acf316503f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895ef94460>]}
19:23:33.061369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67d40cb2-3590-47ee-ad85-64acf316503f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960050df0>]}
19:23:33.061610 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:23:33.061815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67d40cb2-3590-47ee-ad85-64acf316503f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960015f70>]}
19:23:33.062782 [info ] [MainThread]: 
19:23:33.063214 [debug] [MainThread]: Acquiring new postgres connection "master"
19:23:33.063964 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
19:23:33.070979 [debug] [ThreadPool]: Using postgres connection "list_trial"
19:23:33.071167 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
19:23:33.071268 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:23:33.079690 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:23:33.080672 [debug] [ThreadPool]: On list_trial: Close
19:23:33.081790 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
19:23:33.086516 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:23:33.086707 [debug] [ThreadPool]: On list_trial_trial: BEGIN
19:23:33.086803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:23:33.093509 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:23:33.093699 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:23:33.093796 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
19:23:33.095330 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
19:23:33.096137 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
19:23:33.096332 [debug] [ThreadPool]: On list_trial_trial: Close
19:23:33.098994 [debug] [MainThread]: Using postgres connection "master"
19:23:33.099145 [debug] [MainThread]: On master: BEGIN
19:23:33.099254 [debug] [MainThread]: Opening a new connection, currently in state init
19:23:33.104450 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:23:33.104641 [debug] [MainThread]: Using postgres connection "master"
19:23:33.104764 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:23:33.114032 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
19:23:33.115163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67d40cb2-3590-47ee-ad85-64acf316503f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895ef47c40>]}
19:23:33.115454 [debug] [MainThread]: On master: ROLLBACK
19:23:33.115734 [debug] [MainThread]: Using postgres connection "master"
19:23:33.115836 [debug] [MainThread]: On master: BEGIN
19:23:33.116113 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:23:33.116218 [debug] [MainThread]: On master: COMMIT
19:23:33.116311 [debug] [MainThread]: Using postgres connection "master"
19:23:33.116396 [debug] [MainThread]: On master: COMMIT
19:23:33.116518 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:23:33.116619 [debug] [MainThread]: On master: Close
19:23:33.116965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:23:33.117175 [info ] [MainThread]: 
19:23:33.119431 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
19:23:33.119655 [info ] [Thread-1  ]: 1 of 3 START table model trial.my_first_dbt_model .............................. [RUN]
19:23:33.120030 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:33.120176 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
19:23:33.120326 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
19:23:33.121920 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
19:23:33.122184 [debug] [Thread-1  ]: finished collecting timing info
19:23:33.122311 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
19:23:33.147916 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
19:23:33.148436 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:33.148639 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
19:23:33.148795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:23:33.155844 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:23:33.156043 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:33.156149 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:23:33.157060 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
19:23:33.161661 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:33.161829 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:23:33.162248 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:23:33.163768 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:33.163900 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:23:33.164206 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:23:33.171583 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:23:33.171818 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:33.171969 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
19:23:33.173140 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:23:33.177841 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
19:23:33.178034 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
19:23:33.180329 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:23:33.181615 [debug] [Thread-1  ]: finished collecting timing info
19:23:33.181888 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
19:23:33.182546 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67d40cb2-3590-47ee-ad85-64acf316503f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895ef8c550>]}
19:23:33.183013 [info ] [Thread-1  ]: 1 of 3 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.06s]
19:23:33.183954 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
19:23:33.184150 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
19:23:33.184630 [info ] [Thread-1  ]: 2 of 3 START view model trial.traffic_dbt_model ................................ [RUN]
19:23:33.185242 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
19:23:33.185397 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
19:23:33.185535 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
19:23:33.187548 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
19:23:33.187827 [debug] [Thread-1  ]: finished collecting timing info
19:23:33.187953 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
19:23:33.199162 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
19:23:33.199510 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:23:33.199642 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
19:23:33.199736 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:23:33.205857 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:23:33.206054 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:23:33.206207 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with traffic_dbt_model as (

    select id,track_id," type" from datasets

)

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:23:33.207948 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:23:33.209629 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:23:33.209765 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model" rename to "traffic_dbt_model__dbt_backup"
19:23:33.210049 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:23:33.211367 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:23:33.211480 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model__dbt_tmp" rename to "traffic_dbt_model"
19:23:33.211744 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:23:33.212488 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
19:23:33.212604 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:23:33.212699 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
19:23:33.213702 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:23:33.215398 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
19:23:33.215544 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
drop view if exists "trial"."trial"."traffic_dbt_model__dbt_backup" cascade
19:23:33.217412 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:23:33.219127 [debug] [Thread-1  ]: finished collecting timing info
19:23:33.219486 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
19:23:33.220411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67d40cb2-3590-47ee-ad85-64acf316503f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895cf181c0>]}
19:23:33.220816 [info ] [Thread-1  ]: 2 of 3 OK created view model trial.traffic_dbt_model ........................... [[32mCREATE VIEW[0m in 0.04s]
19:23:33.221170 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
19:23:33.221322 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
19:23:33.221620 [info ] [Thread-1  ]: 3 of 3 START view model trial.my_second_dbt_model .............................. [RUN]
19:23:33.222057 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:33.222241 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
19:23:33.222360 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
19:23:33.223945 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
19:23:33.224419 [debug] [Thread-1  ]: finished collecting timing info
19:23:33.224547 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
19:23:33.225856 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
19:23:33.226078 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:33.226201 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
19:23:33.226297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:23:33.231674 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:23:33.231816 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:33.231926 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
19:23:33.232841 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:23:33.234267 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:33.234385 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:23:33.234638 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:23:33.235425 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:23:33.235545 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:33.235640 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
19:23:33.236724 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:23:33.239216 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
19:23:33.239362 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
19:23:33.239719 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:23:33.240619 [debug] [Thread-1  ]: finished collecting timing info
19:23:33.240825 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
19:23:33.241568 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67d40cb2-3590-47ee-ad85-64acf316503f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895cee98b0>]}
19:23:33.241837 [info ] [Thread-1  ]: 3 of 3 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
19:23:33.242163 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
19:23:33.243078 [debug] [MainThread]: Acquiring new postgres connection "master"
19:23:33.243271 [debug] [MainThread]: Using postgres connection "master"
19:23:33.243378 [debug] [MainThread]: On master: BEGIN
19:23:33.243474 [debug] [MainThread]: Opening a new connection, currently in state closed
19:23:33.249205 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:23:33.249416 [debug] [MainThread]: On master: COMMIT
19:23:33.249522 [debug] [MainThread]: Using postgres connection "master"
19:23:33.249617 [debug] [MainThread]: On master: COMMIT
19:23:33.249758 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:23:33.249872 [debug] [MainThread]: On master: Close
19:23:33.250293 [info ] [MainThread]: 
19:23:33.250610 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.19s.
19:23:33.250794 [debug] [MainThread]: Connection 'master' was properly closed.
19:23:33.250886 [debug] [MainThread]: Connection 'model.datawarehouse.my_second_dbt_model' was properly closed.
19:23:33.253803 [info ] [MainThread]: 
19:23:33.254089 [info ] [MainThread]: [32mCompleted successfully[0m
19:23:33.254338 [info ] [MainThread]: 
19:23:33.254522 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
19:23:33.255114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8960015ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89600b0f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89600b0f10>]}
19:23:53.278279 [warn ] [MainThread]: Error sending message, disabling tracking


============================== 2022-07-23 20:05:44.608809 | 379a77cf-5548-4f5c-860b-7fae6d2770ad ==============================
20:05:44.608825 [info ] [MainThread]: Running with dbt=1.1.1
20:05:44.609300 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
20:05:44.609435 [debug] [MainThread]: Tracking: tracking
20:05:44.631350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0ed58b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0ed58c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0ed58c10>]}
20:05:44.658004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:05:44.658226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:05:44.662772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '379a77cf-5548-4f5c-860b-7fae6d2770ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0ec72b50>]}
20:05:44.666340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '379a77cf-5548-4f5c-860b-7fae6d2770ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0ecdf250>]}
20:05:44.666642 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:05:44.666917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '379a77cf-5548-4f5c-860b-7fae6d2770ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0ecdf430>]}
20:05:44.668206 [info ] [MainThread]: 
20:05:44.668677 [debug] [MainThread]: Acquiring new postgres connection "master"
20:05:44.669485 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
20:05:44.678930 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
20:05:44.679320 [debug] [ThreadPool]: On list_trial_trial: BEGIN
20:05:44.679606 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:05:44.693074 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:05:44.693456 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
20:05:44.693706 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
20:05:44.696674 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
20:05:44.699081 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
20:05:44.699551 [debug] [ThreadPool]: On list_trial_trial: Close
20:05:44.706808 [debug] [MainThread]: Using postgres connection "master"
20:05:44.707067 [debug] [MainThread]: On master: BEGIN
20:05:44.707200 [debug] [MainThread]: Opening a new connection, currently in state init
20:05:44.717660 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:05:44.717944 [debug] [MainThread]: Using postgres connection "master"
20:05:44.718087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:05:44.730968 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
20:05:44.733299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '379a77cf-5548-4f5c-860b-7fae6d2770ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0ed69fd0>]}
20:05:44.733740 [debug] [MainThread]: On master: ROLLBACK
20:05:44.734185 [debug] [MainThread]: On master: Close
20:05:44.734801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:05:44.735144 [info ] [MainThread]: 
20:05:44.737983 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
20:05:44.738714 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
20:05:44.738924 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
20:05:44.739112 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
20:05:44.741452 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
20:05:44.741937 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.742223 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
20:05:44.742497 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.743241 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
20:05:44.743548 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
20:05:44.744071 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
20:05:44.744658 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
20:05:44.745118 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
20:05:44.748955 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
20:05:44.749818 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.750404 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
20:05:44.750735 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.751577 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
20:05:44.751798 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
20:05:44.752236 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
20:05:44.752392 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
20:05:44.752534 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
20:05:44.754896 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
20:05:44.755331 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.755538 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
20:05:44.755711 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.756190 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
20:05:44.756404 [debug] [Thread-1  ]: Began running node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
20:05:44.756836 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710"
20:05:44.757134 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
20:05:44.757289 [debug] [Thread-1  ]: Compiling test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
20:05:44.767033 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710"
20:05:44.768270 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.768451 [debug] [Thread-1  ]: Began executing node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
20:05:44.768601 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.769161 [debug] [Thread-1  ]: Finished running node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
20:05:44.769522 [debug] [Thread-1  ]: Began running node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
20:05:44.770044 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.unique_my_first_dbt_model_id.16e066b321"
20:05:44.770506 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
20:05:44.770800 [debug] [Thread-1  ]: Compiling test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
20:05:44.778661 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.unique_my_first_dbt_model_id.16e066b321"
20:05:44.779115 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.779334 [debug] [Thread-1  ]: Began executing node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
20:05:44.779505 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.779999 [debug] [Thread-1  ]: Finished running node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
20:05:44.780209 [debug] [Thread-1  ]: Began running node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
20:05:44.780658 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778"
20:05:44.780811 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
20:05:44.780943 [debug] [Thread-1  ]: Compiling test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
20:05:44.785487 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778"
20:05:44.785866 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.786041 [debug] [Thread-1  ]: Began executing node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
20:05:44.786195 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.786744 [debug] [Thread-1  ]: Finished running node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
20:05:44.786958 [debug] [Thread-1  ]: Began running node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
20:05:44.787389 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493"
20:05:44.787548 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
20:05:44.787686 [debug] [Thread-1  ]: Compiling test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
20:05:44.790490 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493"
20:05:44.790818 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.790984 [debug] [Thread-1  ]: Began executing node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
20:05:44.791127 [debug] [Thread-1  ]: finished collecting timing info
20:05:44.791505 [debug] [Thread-1  ]: Finished running node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
20:05:44.792463 [debug] [MainThread]: Connection 'master' was properly closed.
20:05:44.792694 [debug] [MainThread]: Connection 'test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
20:05:44.796235 [info ] [MainThread]: Done.
20:05:44.799999 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
20:05:44.800300 [info ] [MainThread]: Building catalog
20:05:44.802589 [debug] [ThreadPool]: Acquiring new postgres connection "trial.information_schema"
20:05:44.809709 [debug] [ThreadPool]: Using postgres connection "trial.information_schema"
20:05:44.809945 [debug] [ThreadPool]: On trial.information_schema: BEGIN
20:05:44.810091 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:05:44.819721 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:05:44.820061 [debug] [ThreadPool]: Using postgres connection "trial.information_schema"
20:05:44.820232 [debug] [ThreadPool]: On trial.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "trial.information_schema"} */

    
    

    select
        'trial' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('trial'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
20:05:44.824701 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
20:05:44.830230 [debug] [ThreadPool]: On trial.information_schema: ROLLBACK
20:05:44.830770 [debug] [ThreadPool]: On trial.information_schema: Close
20:05:44.839044 [info ] [MainThread]: Catalog written to /home/hp/Downloads/datawarehouse/target/catalog.json
20:05:44.839753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0ed58b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0e419280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac0e419ee0>]}
20:05:46.055007 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
20:05:46.056011 [debug] [MainThread]: Connection 'trial.information_schema' was properly closed.


============================== 2022-07-24 16:07:20.029931 | 538246ce-1bf4-4877-a045-2b3630f0715b ==============================
16:07:20.029946 [info ] [MainThread]: Running with dbt=1.1.1
16:07:20.030483 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
16:07:20.030598 [debug] [MainThread]: Tracking: tracking
16:07:20.047353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbf4ebdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbf4ebddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbf4ebddc0>]}
16:07:20.050009 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
16:07:20.050279 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
16:07:20.050446 [info ] [MainThread]: 
16:07:20.050605 [info ] [MainThread]: 
16:07:20.050775 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-07-24 18:25:49.082048 | 03d3c503-252c-40f3-996c-d8253af720c4 ==============================
18:25:49.082055 [info ] [MainThread]: Running with dbt=1.1.1
18:25:49.082315 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
18:25:49.082440 [debug] [MainThread]: Tracking: tracking
18:25:49.100310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d2571040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d2565f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d2565f10>]}
18:25:49.152865 [debug] [MainThread]: Executing "git --help"
18:25:49.157763 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
18:25:49.158208 [debug] [MainThread]: STDERR: "b''"
18:25:49.161300 [debug] [MainThread]: Acquiring new postgres connection "debug"
18:25:49.161979 [debug] [MainThread]: Using postgres connection "debug"
18:25:49.162121 [debug] [MainThread]: On debug: select 1 as id
18:25:49.162248 [debug] [MainThread]: Opening a new connection, currently in state init
18:25:49.174387 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
18:25:49.175582 [debug] [MainThread]: On debug: Close
18:25:49.176037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d1bb8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d1bb8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d1bb8700>]}
18:25:50.450771 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-07-24 18:25:56.114955 | 00dba038-746f-4865-b460-bc6a113e742e ==============================
18:25:56.114970 [info ] [MainThread]: Running with dbt=1.1.1
18:25:56.115422 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:25:56.115555 [debug] [MainThread]: Tracking: tracking
18:25:56.133406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748298cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748298cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748298cd30>]}
18:25:56.164089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 2 files changed.
18:25:56.164885 [debug] [MainThread]: Partial parsing: added file: datawarehouse://models/example/traffic_type_model.sql
18:25:56.165167 [debug] [MainThread]: Partial parsing: added file: datawarehouse://models/example/traffic_speed_model.sql
18:25:56.165389 [debug] [MainThread]: Partial parsing: added file: datawarehouse://models/example/traffic_distance_model.sql
18:25:56.165740 [debug] [MainThread]: Partial parsing: update schema file: datawarehouse://models/example/schema.yml
18:25:56.166082 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_dbt_model.sql
18:25:56.178073 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_type_model.sql
18:25:56.187647 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_speed_model.sql
18:25:56.189787 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_distance_model.sql
18:25:56.191616 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_dbt_model.sql
18:25:56.200599 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'datasets' in the 'models' section of file 'models/example/schema.yml'
18:25:56.207480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00dba038-746f-4865-b460-bc6a113e742e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748184ea30>]}
18:25:56.212418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00dba038-746f-4865-b460-bc6a113e742e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748188db50>]}
18:25:56.212805 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:25:56.213135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00dba038-746f-4865-b460-bc6a113e742e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7482911fd0>]}
18:25:56.214647 [info ] [MainThread]: 
18:25:56.215194 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:56.216300 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
18:25:56.226713 [debug] [ThreadPool]: Using postgres connection "list_trial"
18:25:56.226933 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
18:25:56.227053 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:25:56.236216 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:25:56.238012 [debug] [ThreadPool]: On list_trial: Close
18:25:56.239837 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
18:25:56.245098 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:25:56.245300 [debug] [ThreadPool]: On list_trial_trial: BEGIN
18:25:56.245444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:25:56.255353 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:25:56.255758 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:25:56.256016 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
18:25:56.258979 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
18:25:56.260263 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
18:25:56.260591 [debug] [ThreadPool]: On list_trial_trial: Close
18:25:56.264025 [debug] [MainThread]: Using postgres connection "master"
18:25:56.264180 [debug] [MainThread]: On master: BEGIN
18:25:56.264297 [debug] [MainThread]: Opening a new connection, currently in state init
18:25:56.273473 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:25:56.273783 [debug] [MainThread]: Using postgres connection "master"
18:25:56.273982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:25:56.285416 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:25:56.286619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00dba038-746f-4865-b460-bc6a113e742e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74818899a0>]}
18:25:56.286868 [debug] [MainThread]: On master: ROLLBACK
18:25:56.287065 [debug] [MainThread]: Using postgres connection "master"
18:25:56.287178 [debug] [MainThread]: On master: BEGIN
18:25:56.287721 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:25:56.287921 [debug] [MainThread]: On master: COMMIT
18:25:56.288066 [debug] [MainThread]: Using postgres connection "master"
18:25:56.288226 [debug] [MainThread]: On master: COMMIT
18:25:56.288415 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:56.288576 [debug] [MainThread]: On master: Close
18:25:56.289100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:25:56.289371 [info ] [MainThread]: 
18:25:56.292572 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
18:25:56.293197 [info ] [Thread-1  ]: 1 of 4 START table model trial.my_first_dbt_model .............................. [RUN]
18:25:56.293799 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
18:25:56.294006 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
18:25:56.294173 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
18:25:56.296287 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
18:25:56.296608 [debug] [Thread-1  ]: finished collecting timing info
18:25:56.296791 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
18:25:56.318837 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
18:25:56.319338 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:25:56.319522 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
18:25:56.319673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:25:56.327378 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:25:56.327638 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:25:56.327761 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:25:56.332185 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:25:56.338745 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:25:56.339008 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:25:56.339932 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:56.341775 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:25:56.341917 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:25:56.342333 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:56.349266 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:25:56.349391 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:25:56.349488 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:25:56.350814 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:25:56.356113 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:25:56.356413 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
18:25:56.361280 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:25:56.362292 [debug] [Thread-1  ]: finished collecting timing info
18:25:56.362463 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
18:25:56.362877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00dba038-746f-4865-b460-bc6a113e742e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7481013cd0>]}
18:25:56.363195 [info ] [Thread-1  ]: 1 of 4 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.07s]
18:25:56.363565 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
18:25:56.363763 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
18:25:56.364311 [info ] [Thread-1  ]: 2 of 4 START view model trial.traffic_dbt_model ................................ [RUN]
18:25:56.364854 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
18:25:56.365027 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
18:25:56.365189 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
18:25:56.366995 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
18:25:56.367293 [debug] [Thread-1  ]: finished collecting timing info
18:25:56.367435 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
18:25:56.383136 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
18:25:56.383453 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:25:56.383593 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
18:25:56.383694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:25:56.391725 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:25:56.392026 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:25:56.392178 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    

with traffic_dbt_model as (

    select * from datasets

)

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:25:56.395614 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:56.397669 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:25:56.397826 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model" rename to "traffic_dbt_model__dbt_backup"
18:25:56.398163 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:56.399547 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:25:56.399661 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model__dbt_tmp" rename to "traffic_dbt_model"
18:25:56.399964 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:56.400855 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:25:56.400987 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:25:56.401100 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:25:56.402772 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:25:56.404470 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:25:56.404661 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
drop view if exists "trial"."trial"."traffic_dbt_model__dbt_backup" cascade
18:25:56.406943 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:56.408069 [debug] [Thread-1  ]: finished collecting timing info
18:25:56.408257 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
18:25:56.408695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00dba038-746f-4865-b460-bc6a113e742e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748184ee50>]}
18:25:56.409015 [info ] [Thread-1  ]: 2 of 4 OK created view model trial.traffic_dbt_model ........................... [[32mCREATE VIEW[0m in 0.04s]
18:25:56.409381 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
18:25:56.409553 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
18:25:56.409970 [info ] [Thread-1  ]: 3 of 4 START view model trial.my_second_dbt_model .............................. [RUN]
18:25:56.410618 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
18:25:56.410823 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
18:25:56.410969 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
18:25:56.412764 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
18:25:56.413209 [debug] [Thread-1  ]: finished collecting timing info
18:25:56.413345 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
18:25:56.414797 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
18:25:56.415042 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:25:56.415157 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
18:25:56.415257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:25:56.422225 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:25:56.422602 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:25:56.422834 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
18:25:56.425164 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:56.427471 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:25:56.427675 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:25:56.428128 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:56.429878 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:25:56.430079 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:25:56.430212 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:25:56.431726 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:25:56.433043 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:25:56.433171 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
18:25:56.433564 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:56.434410 [debug] [Thread-1  ]: finished collecting timing info
18:25:56.434561 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
18:25:56.435001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00dba038-746f-4865-b460-bc6a113e742e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7480ff82e0>]}
18:25:56.435313 [info ] [Thread-1  ]: 3 of 4 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
18:25:56.435686 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
18:25:56.435871 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_distance_model
18:25:56.436151 [info ] [Thread-1  ]: 4 of 4 START view model trial.traffic_distance_model ........................... [RUN]
18:25:56.436680 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_distance_model"
18:25:56.436910 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_distance_model
18:25:56.437058 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_distance_model
18:25:56.439097 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_distance_model"
18:25:56.439754 [debug] [Thread-1  ]: finished collecting timing info
18:25:56.439996 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_distance_model
18:25:56.442102 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_distance_model"
18:25:56.442425 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:25:56.442580 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: BEGIN
18:25:56.442717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:25:56.449418 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:25:56.449623 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:25:56.449755 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */

  create view "trial"."trial"."traffic_distance_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."traffic_dbt_model"
where id = 1
  );
18:25:56.451374 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:56.453222 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:25:56.453380 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
alter table "trial"."trial"."traffic_distance_model__dbt_tmp" rename to "traffic_distance_model"
18:25:56.453716 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:56.454662 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:25:56.454781 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:25:56.454894 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:25:56.456485 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:25:56.458223 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:25:56.458402 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
drop view if exists "trial"."trial"."traffic_distance_model__dbt_backup" cascade
18:25:56.458748 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:56.459735 [debug] [Thread-1  ]: finished collecting timing info
18:25:56.459995 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: Close
18:25:56.460532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00dba038-746f-4865-b460-bc6a113e742e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7480ff8190>]}
18:25:56.460926 [info ] [Thread-1  ]: 4 of 4 OK created view model trial.traffic_distance_model ...................... [[32mCREATE VIEW[0m in 0.02s]
18:25:56.461353 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_distance_model
18:25:56.462459 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:56.462658 [debug] [MainThread]: Using postgres connection "master"
18:25:56.462780 [debug] [MainThread]: On master: BEGIN
18:25:56.462897 [debug] [MainThread]: Opening a new connection, currently in state closed
18:25:56.469506 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:25:56.469949 [debug] [MainThread]: On master: COMMIT
18:25:56.470075 [debug] [MainThread]: Using postgres connection "master"
18:25:56.470192 [debug] [MainThread]: On master: COMMIT
18:25:56.470472 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:56.470649 [debug] [MainThread]: On master: Close
18:25:56.471105 [info ] [MainThread]: 
18:25:56.471390 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0.26s.
18:25:56.471638 [debug] [MainThread]: Connection 'master' was properly closed.
18:25:56.471769 [debug] [MainThread]: Connection 'model.datawarehouse.traffic_distance_model' was properly closed.
18:25:56.476352 [info ] [MainThread]: 
18:25:56.476709 [info ] [MainThread]: [32mCompleted successfully[0m
18:25:56.477066 [info ] [MainThread]: 
18:25:56.477365 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
18:25:56.477841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7482911fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f748188dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7481889340>]}


============================== 2022-07-24 18:30:44.017133 | 6ce371de-e6db-48d7-88bf-847b5604d70a ==============================
18:30:44.017147 [info ] [MainThread]: Running with dbt=1.1.1
18:30:44.017681 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:30:44.017832 [debug] [MainThread]: Tracking: tracking
18:30:44.038474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340a8b7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340a8b7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340a8b7b50>]}
18:30:44.063073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:30:44.063554 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_type_model.sql
18:30:44.073072 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_type_model.sql
18:30:44.087628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ce371de-e6db-48d7-88bf-847b5604d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34099bcbb0>]}
18:30:44.090730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ce371de-e6db-48d7-88bf-847b5604d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340a83ebb0>]}
18:30:44.090979 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:30:44.091195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce371de-e6db-48d7-88bf-847b5604d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340a83e460>]}
18:30:44.092413 [info ] [MainThread]: 
18:30:44.092942 [debug] [MainThread]: Acquiring new postgres connection "master"
18:30:44.094196 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
18:30:44.105308 [debug] [ThreadPool]: Using postgres connection "list_trial"
18:30:44.105695 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
18:30:44.105904 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:30:44.116561 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:30:44.118370 [debug] [ThreadPool]: On list_trial: Close
18:30:44.120151 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
18:30:44.126104 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:30:44.126268 [debug] [ThreadPool]: On list_trial_trial: BEGIN
18:30:44.126495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:30:44.135111 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:30:44.135410 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:30:44.135597 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
18:30:44.137313 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
18:30:44.138483 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
18:30:44.138764 [debug] [ThreadPool]: On list_trial_trial: Close
18:30:44.143338 [debug] [MainThread]: Using postgres connection "master"
18:30:44.143556 [debug] [MainThread]: On master: BEGIN
18:30:44.143697 [debug] [MainThread]: Opening a new connection, currently in state init
18:30:44.151306 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:30:44.151557 [debug] [MainThread]: Using postgres connection "master"
18:30:44.151715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:30:44.163973 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
18:30:44.165604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce371de-e6db-48d7-88bf-847b5604d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340a83ed30>]}
18:30:44.165892 [debug] [MainThread]: On master: ROLLBACK
18:30:44.166209 [debug] [MainThread]: Using postgres connection "master"
18:30:44.166356 [debug] [MainThread]: On master: BEGIN
18:30:44.166790 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:30:44.167031 [debug] [MainThread]: On master: COMMIT
18:30:44.167201 [debug] [MainThread]: Using postgres connection "master"
18:30:44.167317 [debug] [MainThread]: On master: COMMIT
18:30:44.167480 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:30:44.167613 [debug] [MainThread]: On master: Close
18:30:44.168039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:30:44.168302 [info ] [MainThread]: 
18:30:44.170835 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
18:30:44.171118 [info ] [Thread-1  ]: 1 of 5 START table model trial.my_first_dbt_model .............................. [RUN]
18:30:44.171642 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
18:30:44.171878 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
18:30:44.172050 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
18:30:44.174051 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
18:30:44.174354 [debug] [Thread-1  ]: finished collecting timing info
18:30:44.174515 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
18:30:44.198005 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
18:30:44.198466 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:30:44.198627 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
18:30:44.198748 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:30:44.205401 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:30:44.205609 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:30:44.205740 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:30:44.206816 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:30:44.214476 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:30:44.214751 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:30:44.215194 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.217533 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:30:44.217693 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:30:44.218158 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.226299 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:30:44.226490 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:30:44.226611 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:30:44.227799 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:30:44.231186 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:30:44.231331 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
18:30:44.233493 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:30:44.234623 [debug] [Thread-1  ]: finished collecting timing info
18:30:44.234770 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
18:30:44.235190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce371de-e6db-48d7-88bf-847b5604d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34091064f0>]}
18:30:44.235513 [info ] [Thread-1  ]: 1 of 5 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.06s]
18:30:44.235896 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
18:30:44.236064 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
18:30:44.236244 [info ] [Thread-1  ]: 2 of 5 START view model trial.traffic_dbt_model ................................ [RUN]
18:30:44.236767 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
18:30:44.237141 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
18:30:44.237315 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
18:30:44.239722 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
18:30:44.240107 [debug] [Thread-1  ]: finished collecting timing info
18:30:44.240326 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
18:30:44.260588 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
18:30:44.261040 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:30:44.261182 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
18:30:44.261297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:30:44.268965 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:30:44.269355 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:30:44.269607 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    

with traffic_dbt_model as (

    select * from datasets

)

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:30:44.271496 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:30:44.274154 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:30:44.274304 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model" rename to "traffic_dbt_model__dbt_backup"
18:30:44.274921 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.276780 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:30:44.276957 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model__dbt_tmp" rename to "traffic_dbt_model"
18:30:44.277409 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.278306 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:30:44.278431 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:30:44.278531 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:30:44.279822 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:30:44.281930 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:30:44.282061 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
drop view if exists "trial"."trial"."traffic_dbt_model__dbt_backup" cascade
18:30:44.283888 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:30:44.285401 [debug] [Thread-1  ]: finished collecting timing info
18:30:44.285604 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
18:30:44.286139 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce371de-e6db-48d7-88bf-847b5604d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340913d940>]}
18:30:44.286478 [info ] [Thread-1  ]: 2 of 5 OK created view model trial.traffic_dbt_model ........................... [[32mCREATE VIEW[0m in 0.05s]
18:30:44.286895 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
18:30:44.287094 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
18:30:44.287517 [info ] [Thread-1  ]: 3 of 5 START view model trial.my_second_dbt_model .............................. [RUN]
18:30:44.288309 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
18:30:44.288536 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
18:30:44.288700 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
18:30:44.290640 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
18:30:44.290885 [debug] [Thread-1  ]: finished collecting timing info
18:30:44.291008 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
18:30:44.292828 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
18:30:44.293172 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:30:44.293317 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
18:30:44.293460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:30:44.300310 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:30:44.300514 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:30:44.300647 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
18:30:44.301815 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:30:44.303936 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:30:44.304104 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:30:44.304551 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.305648 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:30:44.305792 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:30:44.305906 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:30:44.307230 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:30:44.309074 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:30:44.309297 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
18:30:44.309650 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:30:44.310606 [debug] [Thread-1  ]: finished collecting timing info
18:30:44.310782 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
18:30:44.311254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce371de-e6db-48d7-88bf-847b5604d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34080ed730>]}
18:30:44.311604 [info ] [Thread-1  ]: 3 of 5 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
18:30:44.312055 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
18:30:44.312345 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_distance_model
18:30:44.312788 [info ] [Thread-1  ]: 4 of 5 START view model trial.traffic_distance_model ........................... [RUN]
18:30:44.313454 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_distance_model"
18:30:44.313671 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_distance_model
18:30:44.313901 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_distance_model
18:30:44.315590 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_distance_model"
18:30:44.315847 [debug] [Thread-1  ]: finished collecting timing info
18:30:44.315972 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_distance_model
18:30:44.317758 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_distance_model"
18:30:44.318012 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:30:44.318131 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: BEGIN
18:30:44.318235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:30:44.326431 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:30:44.326640 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:30:44.326761 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */

  create view "trial"."trial"."traffic_distance_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."traffic_dbt_model"
where id = 1
  );
18:30:44.328638 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:30:44.331069 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:30:44.331278 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
alter table "trial"."trial"."traffic_distance_model__dbt_tmp" rename to "traffic_distance_model"
18:30:44.331994 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.333247 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:30:44.333392 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:30:44.333511 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:30:44.334755 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:30:44.336059 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:30:44.336203 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
drop view if exists "trial"."trial"."traffic_distance_model__dbt_backup" cascade
18:30:44.336478 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:30:44.337626 [debug] [Thread-1  ]: finished collecting timing info
18:30:44.337833 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: Close
18:30:44.338325 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce371de-e6db-48d7-88bf-847b5604d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34080f16a0>]}
18:30:44.338691 [info ] [Thread-1  ]: 4 of 5 OK created view model trial.traffic_distance_model ...................... [[32mCREATE VIEW[0m in 0.03s]
18:30:44.339075 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_distance_model
18:30:44.339253 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_type_model
18:30:44.339631 [info ] [Thread-1  ]: 5 of 5 START view model trial.traffic_type_model ............................... [RUN]
18:30:44.340132 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_type_model"
18:30:44.340312 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_type_model
18:30:44.340459 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_type_model
18:30:44.342864 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_type_model"
18:30:44.343245 [debug] [Thread-1  ]: finished collecting timing info
18:30:44.343440 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_type_model
18:30:44.345477 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_type_model"
18:30:44.345773 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:30:44.345915 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: BEGIN
18:30:44.346028 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:30:44.352510 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:30:44.352672 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:30:44.352994 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */

  create view "trial"."trial"."traffic_type_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select type , COUNT(id) , 
from "trial"."trial"."traffic_dbt_model"
Group by "type"
  );
18:30:44.353486 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 7: from "trial"."trial"."traffic_dbt_model"
        ^

18:30:44.353655 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: ROLLBACK
18:30:44.354001 [debug] [Thread-1  ]: finished collecting timing info
18:30:44.354165 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: Close
18:30:44.354588 [debug] [Thread-1  ]: Database Error in model traffic_type_model (models/example/traffic_type_model.sql)
  syntax error at or near "from"
  LINE 7: from "trial"."trial"."traffic_dbt_model"
          ^
  compiled SQL at target/run/datawarehouse/models/example/traffic_type_model.sql
18:30:44.354846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce371de-e6db-48d7-88bf-847b5604d70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34080465b0>]}
18:30:44.355144 [error] [Thread-1  ]: 5 of 5 ERROR creating view model trial.traffic_type_model ...................... [[31mERROR[0m in 0.01s]
18:30:44.355560 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_type_model
18:30:44.356652 [debug] [MainThread]: Acquiring new postgres connection "master"
18:30:44.356859 [debug] [MainThread]: Using postgres connection "master"
18:30:44.357001 [debug] [MainThread]: On master: BEGIN
18:30:44.357135 [debug] [MainThread]: Opening a new connection, currently in state closed
18:30:44.365308 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:30:44.365627 [debug] [MainThread]: On master: COMMIT
18:30:44.365808 [debug] [MainThread]: Using postgres connection "master"
18:30:44.365973 [debug] [MainThread]: On master: COMMIT
18:30:44.366323 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:30:44.366495 [debug] [MainThread]: On master: Close
18:30:44.367060 [info ] [MainThread]: 
18:30:44.367381 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0.27s.
18:30:44.367631 [debug] [MainThread]: Connection 'master' was properly closed.
18:30:44.367758 [debug] [MainThread]: Connection 'model.datawarehouse.traffic_type_model' was properly closed.
18:30:44.371405 [info ] [MainThread]: 
18:30:44.371653 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:30:44.371888 [info ] [MainThread]: 
18:30:44.372184 [error] [MainThread]: [33mDatabase Error in model traffic_type_model (models/example/traffic_type_model.sql)[0m
18:30:44.372432 [error] [MainThread]:   syntax error at or near "from"
18:30:44.372657 [error] [MainThread]:   LINE 7: from "trial"."trial"."traffic_dbt_model"
18:30:44.372882 [error] [MainThread]:           ^
18:30:44.373096 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_type_model.sql
18:30:44.373492 [info ] [MainThread]: 
18:30:44.373831 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
18:30:44.374193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3409106040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340a8484c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340a83e400>]}


============================== 2022-07-24 18:31:03.297175 | b8bc27db-0fbf-423e-a4e4-61ef60fae441 ==============================
18:31:03.297191 [info ] [MainThread]: Running with dbt=1.1.1
18:31:03.297730 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:31:03.297882 [debug] [MainThread]: Tracking: tracking
18:31:03.317769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92b050b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92b050c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92b050c40>]}
18:31:03.341510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:31:03.341894 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_type_model.sql
18:31:03.351995 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_type_model.sql
18:31:03.366930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8bc27db-0fbf-423e-a4e4-61ef60fae441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92a156cd0>]}
18:31:03.370204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8bc27db-0fbf-423e-a4e4-61ef60fae441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92afe7d60>]}
18:31:03.370456 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:31:03.370680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8bc27db-0fbf-423e-a4e4-61ef60fae441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92afe7f10>]}
18:31:03.371903 [info ] [MainThread]: 
18:31:03.372403 [debug] [MainThread]: Acquiring new postgres connection "master"
18:31:03.373507 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
18:31:03.380948 [debug] [ThreadPool]: Using postgres connection "list_trial"
18:31:03.381154 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
18:31:03.381304 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:31:03.391678 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:31:03.392968 [debug] [ThreadPool]: On list_trial: Close
18:31:03.394872 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
18:31:03.401138 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:31:03.401360 [debug] [ThreadPool]: On list_trial_trial: BEGIN
18:31:03.401489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:31:03.408815 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:31:03.409105 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:31:03.409260 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
18:31:03.411148 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
18:31:03.412302 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
18:31:03.412565 [debug] [ThreadPool]: On list_trial_trial: Close
18:31:03.416072 [debug] [MainThread]: Using postgres connection "master"
18:31:03.416260 [debug] [MainThread]: On master: BEGIN
18:31:03.416394 [debug] [MainThread]: Opening a new connection, currently in state init
18:31:03.424231 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:31:03.424519 [debug] [MainThread]: Using postgres connection "master"
18:31:03.424752 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:31:03.435044 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
18:31:03.436488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8bc27db-0fbf-423e-a4e4-61ef60fae441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92af82760>]}
18:31:03.436759 [debug] [MainThread]: On master: ROLLBACK
18:31:03.437378 [debug] [MainThread]: Using postgres connection "master"
18:31:03.437531 [debug] [MainThread]: On master: BEGIN
18:31:03.438190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:31:03.438396 [debug] [MainThread]: On master: COMMIT
18:31:03.438547 [debug] [MainThread]: Using postgres connection "master"
18:31:03.438683 [debug] [MainThread]: On master: COMMIT
18:31:03.438877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:31:03.439039 [debug] [MainThread]: On master: Close
18:31:03.439477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:31:03.439755 [info ] [MainThread]: 
18:31:03.442568 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
18:31:03.442887 [info ] [Thread-1  ]: 1 of 5 START table model trial.my_first_dbt_model .............................. [RUN]
18:31:03.443497 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:03.443733 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
18:31:03.443946 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
18:31:03.446215 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
18:31:03.446633 [debug] [Thread-1  ]: finished collecting timing info
18:31:03.446797 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
18:31:03.468791 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
18:31:03.469113 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:03.469255 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
18:31:03.469378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:03.477441 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:31:03.477718 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:03.477856 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:31:03.479015 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:31:03.483536 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:03.483682 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:31:03.484214 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:03.486363 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:03.486535 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:31:03.486883 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:03.495959 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:31:03.496154 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:03.496255 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:31:03.497456 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:31:03.500424 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:03.500548 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
18:31:03.502806 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:31:03.503903 [debug] [Thread-1  ]: finished collecting timing info
18:31:03.504059 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
18:31:03.504460 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8bc27db-0fbf-423e-a4e4-61ef60fae441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9298a35e0>]}
18:31:03.504748 [info ] [Thread-1  ]: 1 of 5 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.06s]
18:31:03.505509 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
18:31:03.505781 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
18:31:03.506177 [info ] [Thread-1  ]: 2 of 5 START view model trial.traffic_dbt_model ................................ [RUN]
18:31:03.507215 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:03.507560 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
18:31:03.507854 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
18:31:03.510393 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
18:31:03.510677 [debug] [Thread-1  ]: finished collecting timing info
18:31:03.510819 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
18:31:03.522944 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
18:31:03.523238 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:03.523359 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
18:31:03.523471 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:03.531628 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:31:03.531869 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:03.532055 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    

with traffic_dbt_model as (

    select * from datasets

)

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:31:03.535030 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:31:03.537146 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:03.537326 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model" rename to "traffic_dbt_model__dbt_backup"
18:31:03.538033 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:03.539940 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:03.540113 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model__dbt_tmp" rename to "traffic_dbt_model"
18:31:03.540608 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:03.541788 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:31:03.541960 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:03.542096 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:31:03.543276 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:31:03.545880 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:03.546187 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
drop view if exists "trial"."trial"."traffic_dbt_model__dbt_backup" cascade
18:31:03.548017 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:31:03.549058 [debug] [Thread-1  ]: finished collecting timing info
18:31:03.549229 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
18:31:03.549675 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8bc27db-0fbf-423e-a4e4-61ef60fae441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe928083cd0>]}
18:31:03.549986 [info ] [Thread-1  ]: 2 of 5 OK created view model trial.traffic_dbt_model ........................... [[32mCREATE VIEW[0m in 0.04s]
18:31:03.550379 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
18:31:03.550550 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
18:31:03.551344 [info ] [Thread-1  ]: 3 of 5 START view model trial.my_second_dbt_model .............................. [RUN]
18:31:03.552041 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:03.552244 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
18:31:03.552399 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
18:31:03.554384 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
18:31:03.554664 [debug] [Thread-1  ]: finished collecting timing info
18:31:03.554786 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
18:31:03.556453 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
18:31:03.556697 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:03.556833 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
18:31:03.556941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:03.564629 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:31:03.564924 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:03.565097 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
18:31:03.566384 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:31:03.568246 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:03.568459 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:31:03.568926 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:03.570184 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:31:03.570339 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:03.570482 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:31:03.571687 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:31:03.572929 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:03.573056 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
18:31:03.573434 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:31:03.574413 [debug] [Thread-1  ]: finished collecting timing info
18:31:03.574611 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
18:31:03.575095 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8bc27db-0fbf-423e-a4e4-61ef60fae441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe928061910>]}
18:31:03.575406 [info ] [Thread-1  ]: 3 of 5 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
18:31:03.575811 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
18:31:03.576063 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_distance_model
18:31:03.576466 [info ] [Thread-1  ]: 4 of 5 START view model trial.traffic_distance_model ........................... [RUN]
18:31:03.577034 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_distance_model"
18:31:03.577246 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_distance_model
18:31:03.577441 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_distance_model
18:31:03.579342 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_distance_model"
18:31:03.579650 [debug] [Thread-1  ]: finished collecting timing info
18:31:03.579806 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_distance_model
18:31:03.582371 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_distance_model"
18:31:03.582739 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:31:03.582903 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: BEGIN
18:31:03.583035 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:03.590559 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:31:03.590944 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:31:03.591115 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */

  create view "trial"."trial"."traffic_distance_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."traffic_dbt_model"
where id = 1
  );
18:31:03.593070 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:31:03.595185 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:31:03.595343 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
alter table "trial"."trial"."traffic_distance_model__dbt_tmp" rename to "traffic_distance_model"
18:31:03.595751 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:03.596811 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:31:03.596956 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:31:03.597073 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:31:03.598086 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:31:03.599327 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:31:03.599467 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
drop view if exists "trial"."trial"."traffic_distance_model__dbt_backup" cascade
18:31:03.599690 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:31:03.600420 [debug] [Thread-1  ]: finished collecting timing info
18:31:03.600573 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: Close
18:31:03.601009 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8bc27db-0fbf-423e-a4e4-61ef60fae441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92a109dc0>]}
18:31:03.601318 [info ] [Thread-1  ]: 4 of 5 OK created view model trial.traffic_distance_model ...................... [[32mCREATE VIEW[0m in 0.02s]
18:31:03.601691 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_distance_model
18:31:03.601882 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_type_model
18:31:03.602246 [info ] [Thread-1  ]: 5 of 5 START view model trial.traffic_type_model ............................... [RUN]
18:31:03.602734 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_type_model"
18:31:03.602941 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_type_model
18:31:03.603099 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_type_model
18:31:03.605576 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_type_model"
18:31:03.605960 [debug] [Thread-1  ]: finished collecting timing info
18:31:03.606141 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_type_model
18:31:03.608558 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_type_model"
18:31:03.608944 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:31:03.609091 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: BEGIN
18:31:03.609211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:03.616093 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:31:03.616287 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:31:03.616404 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */

  create view "trial"."trial"."traffic_type_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select "type" , COUNT(id) 
from "trial"."trial"."traffic_dbt_model"
Group by "type"
  );
18:31:03.617243 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "type" does not exist
LINE 6: select "type" , COUNT(id) 
               ^
HINT:  Perhaps you meant to reference the column "traffic_dbt_model. type".

18:31:03.617421 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: ROLLBACK
18:31:03.617743 [debug] [Thread-1  ]: finished collecting timing info
18:31:03.617906 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: Close
18:31:03.618276 [debug] [Thread-1  ]: Database Error in model traffic_type_model (models/example/traffic_type_model.sql)
  column "type" does not exist
  LINE 6: select "type" , COUNT(id) 
                 ^
  HINT:  Perhaps you meant to reference the column "traffic_dbt_model. type".
  compiled SQL at target/run/datawarehouse/models/example/traffic_type_model.sql
18:31:03.618492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8bc27db-0fbf-423e-a4e4-61ef60fae441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe923dc5730>]}
18:31:03.618780 [error] [Thread-1  ]: 5 of 5 ERROR creating view model trial.traffic_type_model ...................... [[31mERROR[0m in 0.02s]
18:31:03.619131 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_type_model
18:31:03.620092 [debug] [MainThread]: Acquiring new postgres connection "master"
18:31:03.620511 [debug] [MainThread]: Using postgres connection "master"
18:31:03.620830 [debug] [MainThread]: On master: BEGIN
18:31:03.620981 [debug] [MainThread]: Opening a new connection, currently in state closed
18:31:03.628620 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:31:03.628956 [debug] [MainThread]: On master: COMMIT
18:31:03.629114 [debug] [MainThread]: Using postgres connection "master"
18:31:03.629261 [debug] [MainThread]: On master: COMMIT
18:31:03.629481 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:31:03.629648 [debug] [MainThread]: On master: Close
18:31:03.630190 [info ] [MainThread]: 
18:31:03.630498 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0.26s.
18:31:03.630746 [debug] [MainThread]: Connection 'master' was properly closed.
18:31:03.630880 [debug] [MainThread]: Connection 'model.datawarehouse.traffic_type_model' was properly closed.
18:31:03.634568 [info ] [MainThread]: 
18:31:03.634825 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:31:03.635064 [info ] [MainThread]: 
18:31:03.635299 [error] [MainThread]: [33mDatabase Error in model traffic_type_model (models/example/traffic_type_model.sql)[0m
18:31:03.635513 [error] [MainThread]:   column "type" does not exist
18:31:03.635740 [error] [MainThread]:   LINE 6: select "type" , COUNT(id) 
18:31:03.635981 [error] [MainThread]:                  ^
18:31:03.636214 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "traffic_dbt_model. type".
18:31:03.636445 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_type_model.sql
18:31:03.636711 [info ] [MainThread]: 
18:31:03.636981 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
18:31:03.637303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92afdb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9298a3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92afe7fa0>]}


============================== 2022-07-24 18:31:37.405048 | cfe8c4f3-10ba-4754-a261-291538971a2d ==============================
18:31:37.405061 [info ] [MainThread]: Running with dbt=1.1.1
18:31:37.405619 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:31:37.405781 [debug] [MainThread]: Tracking: tracking
18:31:37.427660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c1000c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c1000d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c1000d00>]}
18:31:37.450595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:31:37.450974 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_type_model.sql
18:31:37.462661 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_type_model.sql
18:31:37.477404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfe8c4f3-10ba-4754-a261-291538971a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c0106d30>]}
18:31:37.480604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfe8c4f3-10ba-4754-a261-291538971a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c0f97dc0>]}
18:31:37.481148 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:31:37.481432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfe8c4f3-10ba-4754-a261-291538971a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c0f97fa0>]}
18:31:37.482680 [info ] [MainThread]: 
18:31:37.483195 [debug] [MainThread]: Acquiring new postgres connection "master"
18:31:37.484293 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
18:31:37.493448 [debug] [ThreadPool]: Using postgres connection "list_trial"
18:31:37.493712 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
18:31:37.493890 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:31:37.505291 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:31:37.507046 [debug] [ThreadPool]: On list_trial: Close
18:31:37.509145 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
18:31:37.515919 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:31:37.516092 [debug] [ThreadPool]: On list_trial_trial: BEGIN
18:31:37.516207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:31:37.522632 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:31:37.522869 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:31:37.523033 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
18:31:37.525327 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
18:31:37.526694 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
18:31:37.527039 [debug] [ThreadPool]: On list_trial_trial: Close
18:31:37.531105 [debug] [MainThread]: Using postgres connection "master"
18:31:37.531261 [debug] [MainThread]: On master: BEGIN
18:31:37.531371 [debug] [MainThread]: Opening a new connection, currently in state init
18:31:37.538897 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:31:37.539094 [debug] [MainThread]: Using postgres connection "master"
18:31:37.539230 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:31:37.551618 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
18:31:37.553383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfe8c4f3-10ba-4754-a261-291538971a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c0f35730>]}
18:31:37.553709 [debug] [MainThread]: On master: ROLLBACK
18:31:37.554065 [debug] [MainThread]: Using postgres connection "master"
18:31:37.554175 [debug] [MainThread]: On master: BEGIN
18:31:37.554517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:31:37.554635 [debug] [MainThread]: On master: COMMIT
18:31:37.554753 [debug] [MainThread]: Using postgres connection "master"
18:31:37.554852 [debug] [MainThread]: On master: COMMIT
18:31:37.555150 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:31:37.555275 [debug] [MainThread]: On master: Close
18:31:37.555743 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:31:37.555987 [info ] [MainThread]: 
18:31:37.558871 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
18:31:37.559266 [info ] [Thread-1  ]: 1 of 5 START table model trial.my_first_dbt_model .............................. [RUN]
18:31:37.559831 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:37.560343 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
18:31:37.560528 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
18:31:37.562986 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
18:31:37.563360 [debug] [Thread-1  ]: finished collecting timing info
18:31:37.563542 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
18:31:37.585640 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
18:31:37.586068 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:37.586243 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
18:31:37.586365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:37.593754 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:31:37.594115 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:37.594380 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:31:37.596031 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:31:37.602567 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:37.602726 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:31:37.603310 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:37.605290 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:37.605431 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:31:37.605899 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:37.616003 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:31:37.616362 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:37.616566 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:31:37.618144 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:31:37.621942 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:31:37.622114 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
18:31:37.624317 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:31:37.625859 [debug] [Thread-1  ]: finished collecting timing info
18:31:37.625998 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
18:31:37.626376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe8c4f3-10ba-4754-a261-291538971a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c00566d0>]}
18:31:37.626642 [info ] [Thread-1  ]: 1 of 5 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.07s]
18:31:37.627014 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
18:31:37.627178 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
18:31:37.627596 [info ] [Thread-1  ]: 2 of 5 START view model trial.traffic_dbt_model ................................ [RUN]
18:31:37.628213 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:37.628443 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
18:31:37.628885 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
18:31:37.630946 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
18:31:37.631234 [debug] [Thread-1  ]: finished collecting timing info
18:31:37.631369 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
18:31:37.643770 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
18:31:37.644052 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:37.644184 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
18:31:37.644279 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:37.652073 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:31:37.652416 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:37.652654 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    

with traffic_dbt_model as (

    select * from datasets

)

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:31:37.654269 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:31:37.656835 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:37.657021 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model" rename to "traffic_dbt_model__dbt_backup"
18:31:37.657867 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:37.659644 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:37.659777 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model__dbt_tmp" rename to "traffic_dbt_model"
18:31:37.660488 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:37.661574 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:31:37.661724 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:37.661833 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:31:37.662951 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:31:37.666274 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:31:37.666487 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
drop view if exists "trial"."trial"."traffic_dbt_model__dbt_backup" cascade
18:31:37.668658 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:31:37.670112 [debug] [Thread-1  ]: finished collecting timing info
18:31:37.670341 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
18:31:37.670861 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe8c4f3-10ba-4754-a261-291538971a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c0038eb0>]}
18:31:37.671214 [info ] [Thread-1  ]: 2 of 5 OK created view model trial.traffic_dbt_model ........................... [[32mCREATE VIEW[0m in 0.04s]
18:31:37.671636 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
18:31:37.671960 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
18:31:37.672440 [info ] [Thread-1  ]: 3 of 5 START view model trial.my_second_dbt_model .............................. [RUN]
18:31:37.672990 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:37.673167 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
18:31:37.673311 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
18:31:37.675566 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
18:31:37.675864 [debug] [Thread-1  ]: finished collecting timing info
18:31:37.676008 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
18:31:37.677676 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
18:31:37.677974 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:37.678107 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
18:31:37.678215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:37.686499 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:31:37.686831 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:37.687035 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
18:31:37.688610 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:31:37.690702 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:37.690851 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:31:37.691550 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:37.692688 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:31:37.692861 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:37.692987 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:31:37.694190 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:31:37.695562 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:31:37.695708 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
18:31:37.695948 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:31:37.696758 [debug] [Thread-1  ]: finished collecting timing info
18:31:37.696918 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
18:31:37.697355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe8c4f3-10ba-4754-a261-291538971a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63a5dc0d30>]}
18:31:37.697711 [info ] [Thread-1  ]: 3 of 5 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
18:31:37.698338 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
18:31:37.698641 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_distance_model
18:31:37.699115 [info ] [Thread-1  ]: 4 of 5 START view model trial.traffic_distance_model ........................... [RUN]
18:31:37.699900 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_distance_model"
18:31:37.700157 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_distance_model
18:31:37.700389 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_distance_model
18:31:37.703183 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_distance_model"
18:31:37.703581 [debug] [Thread-1  ]: finished collecting timing info
18:31:37.703818 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_distance_model
18:31:37.706498 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_distance_model"
18:31:37.706874 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:31:37.707040 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: BEGIN
18:31:37.707174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:37.715538 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:31:37.715799 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:31:37.715921 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */

  create view "trial"."trial"."traffic_distance_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."traffic_dbt_model"
where id = 1
  );
18:31:37.718796 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:31:37.720829 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:31:37.720976 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
alter table "trial"."trial"."traffic_distance_model__dbt_tmp" rename to "traffic_distance_model"
18:31:37.721547 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:31:37.722715 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:31:37.722859 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:31:37.722992 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:31:37.724067 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:31:37.725731 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:31:37.725967 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
drop view if exists "trial"."trial"."traffic_distance_model__dbt_backup" cascade
18:31:37.726312 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:31:37.727842 [debug] [Thread-1  ]: finished collecting timing info
18:31:37.728098 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: Close
18:31:37.728826 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe8c4f3-10ba-4754-a261-291538971a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c0056250>]}
18:31:37.729356 [info ] [Thread-1  ]: 4 of 5 OK created view model trial.traffic_distance_model ...................... [[32mCREATE VIEW[0m in 0.03s]
18:31:37.729994 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_distance_model
18:31:37.730297 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_type_model
18:31:37.730744 [info ] [Thread-1  ]: 5 of 5 START view model trial.traffic_type_model ............................... [RUN]
18:31:37.731473 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_type_model"
18:31:37.731728 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_type_model
18:31:37.731943 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_type_model
18:31:37.734669 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_type_model"
18:31:37.735020 [debug] [Thread-1  ]: finished collecting timing info
18:31:37.735194 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_type_model
18:31:37.737245 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_type_model"
18:31:37.737536 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:31:37.737678 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: BEGIN
18:31:37.737792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:37.745047 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:31:37.745267 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:31:37.745427 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */

  create view "trial"."trial"."traffic_type_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select type , COUNT(id) 
from "trial"."trial"."traffic_dbt_model"
Group by type
  );
18:31:37.746144 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "type" does not exist
LINE 6: select type , COUNT(id) 
               ^
HINT:  Perhaps you meant to reference the column "traffic_dbt_model. type".

18:31:37.746288 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: ROLLBACK
18:31:37.746595 [debug] [Thread-1  ]: finished collecting timing info
18:31:37.746751 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: Close
18:31:37.747167 [debug] [Thread-1  ]: Database Error in model traffic_type_model (models/example/traffic_type_model.sql)
  column "type" does not exist
  LINE 6: select type , COUNT(id) 
                 ^
  HINT:  Perhaps you meant to reference the column "traffic_dbt_model. type".
  compiled SQL at target/run/datawarehouse/models/example/traffic_type_model.sql
18:31:37.747429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe8c4f3-10ba-4754-a261-291538971a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63a5d80760>]}
18:31:37.747776 [error] [Thread-1  ]: 5 of 5 ERROR creating view model trial.traffic_type_model ...................... [[31mERROR[0m in 0.02s]
18:31:37.748193 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_type_model
18:31:37.749690 [debug] [MainThread]: Acquiring new postgres connection "master"
18:31:37.749911 [debug] [MainThread]: Using postgres connection "master"
18:31:37.750061 [debug] [MainThread]: On master: BEGIN
18:31:37.750189 [debug] [MainThread]: Opening a new connection, currently in state closed
18:31:37.757893 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:31:37.758221 [debug] [MainThread]: On master: COMMIT
18:31:37.758409 [debug] [MainThread]: Using postgres connection "master"
18:31:37.758576 [debug] [MainThread]: On master: COMMIT
18:31:37.758834 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:31:37.759031 [debug] [MainThread]: On master: Close
18:31:37.759652 [info ] [MainThread]: 
18:31:37.759986 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0.28s.
18:31:37.760259 [debug] [MainThread]: Connection 'master' was properly closed.
18:31:37.760411 [debug] [MainThread]: Connection 'model.datawarehouse.traffic_type_model' was properly closed.
18:31:37.764704 [info ] [MainThread]: 
18:31:37.765049 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:31:37.765361 [info ] [MainThread]: 
18:31:37.765607 [error] [MainThread]: [33mDatabase Error in model traffic_type_model (models/example/traffic_type_model.sql)[0m
18:31:37.765882 [error] [MainThread]:   column "type" does not exist
18:31:37.766170 [error] [MainThread]:   LINE 6: select type , COUNT(id) 
18:31:37.766484 [error] [MainThread]:                  ^
18:31:37.766773 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "traffic_dbt_model. type".
18:31:37.767060 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_type_model.sql
18:31:37.767372 [info ] [MainThread]: 
18:31:37.767717 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
18:31:37.768129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c0f8ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c0056160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63c0f97e80>]}


============================== 2022-07-24 18:32:04.699674 | 0418623c-9009-438f-867d-c25e1898d8b2 ==============================
18:32:04.699688 [info ] [MainThread]: Running with dbt=1.1.1
18:32:04.700223 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:32:04.700386 [debug] [MainThread]: Tracking: tracking
18:32:04.722916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e9c05be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e9c05cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e9c05ca0>]}
18:32:04.749135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:32:04.749621 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_type_model.sql
18:32:04.759111 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_type_model.sql
18:32:04.773173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0418623c-9009-438f-867d-c25e1898d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e8b0ccd0>]}
18:32:04.776285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0418623c-9009-438f-867d-c25e1898d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e9b9ed60>]}
18:32:04.776529 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:32:04.776792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0418623c-9009-438f-867d-c25e1898d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e9b9ef10>]}
18:32:04.778129 [info ] [MainThread]: 
18:32:04.778596 [debug] [MainThread]: Acquiring new postgres connection "master"
18:32:04.779650 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
18:32:04.788311 [debug] [ThreadPool]: Using postgres connection "list_trial"
18:32:04.788572 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
18:32:04.788712 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:32:04.797950 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:32:04.799610 [debug] [ThreadPool]: On list_trial: Close
18:32:04.801491 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
18:32:04.807959 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:32:04.808138 [debug] [ThreadPool]: On list_trial_trial: BEGIN
18:32:04.808248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:32:04.815863 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:32:04.816129 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:32:04.816302 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
18:32:04.818395 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
18:32:04.820087 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
18:32:04.820454 [debug] [ThreadPool]: On list_trial_trial: Close
18:32:04.824994 [debug] [MainThread]: Using postgres connection "master"
18:32:04.825221 [debug] [MainThread]: On master: BEGIN
18:32:04.825382 [debug] [MainThread]: Opening a new connection, currently in state init
18:32:04.832576 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:32:04.832841 [debug] [MainThread]: Using postgres connection "master"
18:32:04.832964 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:32:04.844307 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
18:32:04.845609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0418623c-9009-438f-867d-c25e1898d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e9b3a760>]}
18:32:04.845862 [debug] [MainThread]: On master: ROLLBACK
18:32:04.846258 [debug] [MainThread]: Using postgres connection "master"
18:32:04.846403 [debug] [MainThread]: On master: BEGIN
18:32:04.847009 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:32:04.847179 [debug] [MainThread]: On master: COMMIT
18:32:04.847311 [debug] [MainThread]: Using postgres connection "master"
18:32:04.847429 [debug] [MainThread]: On master: COMMIT
18:32:04.847612 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:32:04.847746 [debug] [MainThread]: On master: Close
18:32:04.848207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:32:04.848455 [info ] [MainThread]: 
18:32:04.851369 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
18:32:04.851798 [info ] [Thread-1  ]: 1 of 5 START table model trial.my_first_dbt_model .............................. [RUN]
18:32:04.852260 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:04.852434 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
18:32:04.852590 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
18:32:04.854609 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
18:32:04.854922 [debug] [Thread-1  ]: finished collecting timing info
18:32:04.855092 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
18:32:04.879263 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
18:32:04.879727 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:04.879906 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
18:32:04.880056 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:04.888141 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:32:04.888350 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:04.888483 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:32:04.889489 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:32:04.895104 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:04.895468 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:32:04.896059 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:04.898046 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:04.898191 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:32:04.898531 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:04.906687 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:32:04.906854 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:04.906972 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:32:04.908230 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:32:04.911277 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:04.911413 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
18:32:04.913393 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:32:04.914388 [debug] [Thread-1  ]: finished collecting timing info
18:32:04.914533 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
18:32:04.914935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0418623c-9009-438f-867d-c25e1898d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e825b5e0>]}
18:32:04.915231 [info ] [Thread-1  ]: 1 of 5 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.06s]
18:32:04.915614 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
18:32:04.915776 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
18:32:04.916177 [info ] [Thread-1  ]: 2 of 5 START view model trial.traffic_dbt_model ................................ [RUN]
18:32:04.916736 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:04.916961 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
18:32:04.917109 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
18:32:04.919639 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
18:32:04.920046 [debug] [Thread-1  ]: finished collecting timing info
18:32:04.920286 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
18:32:04.943252 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
18:32:04.943667 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:04.943847 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
18:32:04.943990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:04.952829 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:32:04.953102 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:04.953250 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    

with traffic_dbt_model as (

    select * from datasets

)

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:32:04.954830 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:32:04.956803 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:04.956947 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model" rename to "traffic_dbt_model__dbt_backup"
18:32:04.957295 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:04.958684 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:04.958822 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model__dbt_tmp" rename to "traffic_dbt_model"
18:32:04.959128 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:04.959996 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:32:04.960125 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:04.960217 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:32:04.961361 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:32:04.963450 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:04.963598 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
drop view if exists "trial"."trial"."traffic_dbt_model__dbt_backup" cascade
18:32:04.965460 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:32:04.966394 [debug] [Thread-1  ]: finished collecting timing info
18:32:04.966589 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
18:32:04.967053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0418623c-9009-438f-867d-c25e1898d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e823dc70>]}
18:32:04.967370 [info ] [Thread-1  ]: 2 of 5 OK created view model trial.traffic_dbt_model ........................... [[32mCREATE VIEW[0m in 0.05s]
18:32:04.967742 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
18:32:04.967997 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
18:32:04.968388 [info ] [Thread-1  ]: 3 of 5 START view model trial.my_second_dbt_model .............................. [RUN]
18:32:04.969029 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:04.969213 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
18:32:04.969360 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
18:32:04.971346 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
18:32:04.971685 [debug] [Thread-1  ]: finished collecting timing info
18:32:04.971873 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
18:32:04.973986 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
18:32:04.974278 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:04.974411 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
18:32:04.974524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:04.983239 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:32:04.983528 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:04.983684 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
18:32:04.985178 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:32:04.988054 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:04.988234 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:32:04.988854 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:04.989943 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:32:04.990081 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:04.990193 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:32:04.991407 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:32:04.992715 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:04.993009 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
18:32:04.993304 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:32:04.994123 [debug] [Thread-1  ]: finished collecting timing info
18:32:04.994277 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
18:32:04.994690 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0418623c-9009-438f-867d-c25e1898d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e822b730>]}
18:32:04.994987 [info ] [Thread-1  ]: 3 of 5 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.03s]
18:32:04.995348 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
18:32:04.995523 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_distance_model
18:32:04.995911 [info ] [Thread-1  ]: 4 of 5 START view model trial.traffic_distance_model ........................... [RUN]
18:32:04.996413 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_distance_model"
18:32:04.996578 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_distance_model
18:32:04.996743 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_distance_model
18:32:04.999234 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_distance_model"
18:32:04.999649 [debug] [Thread-1  ]: finished collecting timing info
18:32:04.999833 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_distance_model
18:32:05.002114 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_distance_model"
18:32:05.002515 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:32:05.002699 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: BEGIN
18:32:05.002853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:05.010002 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:32:05.010282 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:32:05.010408 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */

  create view "trial"."trial"."traffic_distance_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."traffic_dbt_model"
where id = 1
  );
18:32:05.011795 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:32:05.013644 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:32:05.013784 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
alter table "trial"."trial"."traffic_distance_model__dbt_tmp" rename to "traffic_distance_model"
18:32:05.014215 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:05.015146 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:32:05.015531 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:32:05.015668 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:32:05.016927 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:32:05.018551 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:32:05.018713 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
drop view if exists "trial"."trial"."traffic_distance_model__dbt_backup" cascade
18:32:05.019014 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:32:05.019906 [debug] [Thread-1  ]: finished collecting timing info
18:32:05.020074 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: Close
18:32:05.020526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0418623c-9009-438f-867d-c25e1898d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e825b1f0>]}
18:32:05.021013 [info ] [Thread-1  ]: 4 of 5 OK created view model trial.traffic_distance_model ...................... [[32mCREATE VIEW[0m in 0.02s]
18:32:05.021497 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_distance_model
18:32:05.021701 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_type_model
18:32:05.022391 [info ] [Thread-1  ]: 5 of 5 START view model trial.traffic_type_model ............................... [RUN]
18:32:05.022960 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_type_model"
18:32:05.023147 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_type_model
18:32:05.023375 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_type_model
18:32:05.025442 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_type_model"
18:32:05.025748 [debug] [Thread-1  ]: finished collecting timing info
18:32:05.025906 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_type_model
18:32:05.027573 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_type_model"
18:32:05.027833 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:32:05.027963 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: BEGIN
18:32:05.028079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:05.035858 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:32:05.036252 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:32:05.036399 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */

  create view "trial"."trial"."traffic_type_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select " type" , COUNT(id) 
from "trial"."trial"."traffic_dbt_model"
Group by type
  );
18:32:05.037338 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "type" does not exist
LINE 8: Group by type
                 ^
HINT:  Perhaps you meant to reference the column "traffic_dbt_model. type".

18:32:05.037571 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: ROLLBACK
18:32:05.037975 [debug] [Thread-1  ]: finished collecting timing info
18:32:05.038157 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: Close
18:32:05.038593 [debug] [Thread-1  ]: Database Error in model traffic_type_model (models/example/traffic_type_model.sql)
  column "type" does not exist
  LINE 8: Group by type
                   ^
  HINT:  Perhaps you meant to reference the column "traffic_dbt_model. type".
  compiled SQL at target/run/datawarehouse/models/example/traffic_type_model.sql
18:32:05.038852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0418623c-9009-438f-867d-c25e1898d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e819c730>]}
18:32:05.039187 [error] [Thread-1  ]: 5 of 5 ERROR creating view model trial.traffic_type_model ...................... [[31mERROR[0m in 0.02s]
18:32:05.040057 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_type_model
18:32:05.041200 [debug] [MainThread]: Acquiring new postgres connection "master"
18:32:05.041433 [debug] [MainThread]: Using postgres connection "master"
18:32:05.041602 [debug] [MainThread]: On master: BEGIN
18:32:05.041736 [debug] [MainThread]: Opening a new connection, currently in state closed
18:32:05.048568 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:32:05.048757 [debug] [MainThread]: On master: COMMIT
18:32:05.049126 [debug] [MainThread]: Using postgres connection "master"
18:32:05.049269 [debug] [MainThread]: On master: COMMIT
18:32:05.049471 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:32:05.049614 [debug] [MainThread]: On master: Close
18:32:05.050107 [info ] [MainThread]: 
18:32:05.050458 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0.27s.
18:32:05.050893 [debug] [MainThread]: Connection 'master' was properly closed.
18:32:05.051094 [debug] [MainThread]: Connection 'model.datawarehouse.traffic_type_model' was properly closed.
18:32:05.055286 [info ] [MainThread]: 
18:32:05.055628 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:32:05.056017 [info ] [MainThread]: 
18:32:05.056326 [error] [MainThread]: [33mDatabase Error in model traffic_type_model (models/example/traffic_type_model.sql)[0m
18:32:05.056608 [error] [MainThread]:   column "type" does not exist
18:32:05.056934 [error] [MainThread]:   LINE 8: Group by type
18:32:05.057267 [error] [MainThread]:                    ^
18:32:05.057728 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "traffic_dbt_model. type".
18:32:05.058153 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_type_model.sql
18:32:05.058566 [info ] [MainThread]: 
18:32:05.058925 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
18:32:05.059388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e9c1d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e825b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42e9b9efa0>]}


============================== 2022-07-24 18:32:14.505117 | 0c859e50-2042-4bbf-a31f-5623e8822abc ==============================
18:32:14.505130 [info ] [MainThread]: Running with dbt=1.1.1
18:32:14.505701 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:32:14.505932 [debug] [MainThread]: Tracking: tracking
18:32:14.525279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1e018be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1e018cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1e018ca0>]}
18:32:14.548887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:32:14.549305 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_type_model.sql
18:32:14.559671 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_type_model.sql
18:32:14.575423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c859e50-2042-4bbf-a31f-5623e8822abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1cf1ecd0>]}
18:32:14.578696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c859e50-2042-4bbf-a31f-5623e8822abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1dfafd60>]}
18:32:14.578962 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:32:14.579302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c859e50-2042-4bbf-a31f-5623e8822abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1dfaff10>]}
18:32:14.580834 [info ] [MainThread]: 
18:32:14.581333 [debug] [MainThread]: Acquiring new postgres connection "master"
18:32:14.582445 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
18:32:14.590012 [debug] [ThreadPool]: Using postgres connection "list_trial"
18:32:14.590199 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
18:32:14.590327 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:32:14.599919 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:32:14.601280 [debug] [ThreadPool]: On list_trial: Close
18:32:14.602753 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
18:32:14.610969 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:32:14.611211 [debug] [ThreadPool]: On list_trial_trial: BEGIN
18:32:14.611363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:32:14.618272 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:32:14.618486 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:32:14.618622 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
18:32:14.620384 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
18:32:14.621561 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
18:32:14.621969 [debug] [ThreadPool]: On list_trial_trial: Close
18:32:14.626565 [debug] [MainThread]: Using postgres connection "master"
18:32:14.626770 [debug] [MainThread]: On master: BEGIN
18:32:14.626890 [debug] [MainThread]: Opening a new connection, currently in state init
18:32:14.634455 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:32:14.634651 [debug] [MainThread]: Using postgres connection "master"
18:32:14.634783 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:32:14.644216 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
18:32:14.645778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c859e50-2042-4bbf-a31f-5623e8822abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1df4d760>]}
18:32:14.646027 [debug] [MainThread]: On master: ROLLBACK
18:32:14.646461 [debug] [MainThread]: Using postgres connection "master"
18:32:14.646628 [debug] [MainThread]: On master: BEGIN
18:32:14.647028 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:32:14.647223 [debug] [MainThread]: On master: COMMIT
18:32:14.647359 [debug] [MainThread]: Using postgres connection "master"
18:32:14.647485 [debug] [MainThread]: On master: COMMIT
18:32:14.647660 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:32:14.647807 [debug] [MainThread]: On master: Close
18:32:14.648211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:32:14.648486 [info ] [MainThread]: 
18:32:14.651021 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
18:32:14.651342 [info ] [Thread-1  ]: 1 of 5 START table model trial.my_first_dbt_model .............................. [RUN]
18:32:14.651898 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:14.652113 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
18:32:14.652292 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
18:32:14.654422 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
18:32:14.654736 [debug] [Thread-1  ]: finished collecting timing info
18:32:14.654893 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
18:32:14.680664 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
18:32:14.681145 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:14.681331 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
18:32:14.681477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:14.688223 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:32:14.688420 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:14.688543 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:32:14.689649 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:32:14.694514 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:14.694694 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:32:14.695208 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:14.697413 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:14.697553 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:32:14.698215 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:14.707296 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:32:14.707459 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:14.707551 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:32:14.709287 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:32:14.712477 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:32:14.712599 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
18:32:14.715226 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:32:14.716344 [debug] [Thread-1  ]: finished collecting timing info
18:32:14.716559 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
18:32:14.717058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c859e50-2042-4bbf-a31f-5623e8822abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1c66e5e0>]}
18:32:14.717603 [info ] [Thread-1  ]: 1 of 5 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.07s]
18:32:14.718101 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
18:32:14.718317 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
18:32:14.718759 [info ] [Thread-1  ]: 2 of 5 START view model trial.traffic_dbt_model ................................ [RUN]
18:32:14.719343 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:14.719527 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
18:32:14.719692 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
18:32:14.721874 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
18:32:14.722276 [debug] [Thread-1  ]: finished collecting timing info
18:32:14.722411 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
18:32:14.734701 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
18:32:14.735120 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:14.735269 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
18:32:14.735390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:14.743071 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:32:14.743281 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:14.743411 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    

with traffic_dbt_model as (

    select * from datasets

)

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:32:14.744806 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:32:14.747313 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:14.747520 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model" rename to "traffic_dbt_model__dbt_backup"
18:32:14.747992 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:14.749999 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:14.750169 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model__dbt_tmp" rename to "traffic_dbt_model"
18:32:14.750626 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:14.753125 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:32:14.753441 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:14.753605 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:32:14.754851 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:32:14.756487 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:32:14.756631 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
drop view if exists "trial"."trial"."traffic_dbt_model__dbt_backup" cascade
18:32:14.758849 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:32:14.759806 [debug] [Thread-1  ]: finished collecting timing info
18:32:14.759956 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
18:32:14.760398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c859e50-2042-4bbf-a31f-5623e8822abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1c6505b0>]}
18:32:14.760702 [info ] [Thread-1  ]: 2 of 5 OK created view model trial.traffic_dbt_model ........................... [[32mCREATE VIEW[0m in 0.04s]
18:32:14.761390 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
18:32:14.761568 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
18:32:14.762062 [info ] [Thread-1  ]: 3 of 5 START view model trial.my_second_dbt_model .............................. [RUN]
18:32:14.762601 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:14.763051 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
18:32:14.763227 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
18:32:14.765243 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
18:32:14.765546 [debug] [Thread-1  ]: finished collecting timing info
18:32:14.765693 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
18:32:14.767219 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
18:32:14.767479 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:14.767639 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
18:32:14.767745 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:14.775828 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:32:14.776111 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:14.776263 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
18:32:14.777654 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:32:14.780286 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:14.780497 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:32:14.780987 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:14.782373 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:32:14.782515 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:14.782625 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:32:14.783733 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:32:14.785072 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:32:14.785228 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
18:32:14.785617 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:32:14.786520 [debug] [Thread-1  ]: finished collecting timing info
18:32:14.786697 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
18:32:14.787137 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c859e50-2042-4bbf-a31f-5623e8822abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1c67b8e0>]}
18:32:14.787449 [info ] [Thread-1  ]: 3 of 5 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
18:32:14.787825 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
18:32:14.787997 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_distance_model
18:32:14.788299 [info ] [Thread-1  ]: 4 of 5 START view model trial.traffic_distance_model ........................... [RUN]
18:32:14.789168 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_distance_model"
18:32:14.789344 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_distance_model
18:32:14.789549 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_distance_model
18:32:14.791420 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_distance_model"
18:32:14.791754 [debug] [Thread-1  ]: finished collecting timing info
18:32:14.791931 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_distance_model
18:32:14.793869 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_distance_model"
18:32:14.794292 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:32:14.794527 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: BEGIN
18:32:14.794684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:14.802977 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:32:14.803281 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:32:14.803427 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */

  create view "trial"."trial"."traffic_distance_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."traffic_dbt_model"
where id = 1
  );
18:32:14.804774 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:32:14.806936 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:32:14.807113 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
alter table "trial"."trial"."traffic_distance_model__dbt_tmp" rename to "traffic_distance_model"
18:32:14.807791 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:14.808941 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:32:14.809082 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:32:14.809197 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: COMMIT
18:32:14.810571 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:32:14.812670 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_distance_model"
18:32:14.812889 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_distance_model"} */
drop view if exists "trial"."trial"."traffic_distance_model__dbt_backup" cascade
18:32:14.813343 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:32:14.814288 [debug] [Thread-1  ]: finished collecting timing info
18:32:14.814458 [debug] [Thread-1  ]: On model.datawarehouse.traffic_distance_model: Close
18:32:14.814868 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c859e50-2042-4bbf-a31f-5623e8822abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1c639af0>]}
18:32:14.815166 [info ] [Thread-1  ]: 4 of 5 OK created view model trial.traffic_distance_model ...................... [[32mCREATE VIEW[0m in 0.03s]
18:32:14.815524 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_distance_model
18:32:14.815782 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_type_model
18:32:14.815994 [info ] [Thread-1  ]: 5 of 5 START view model trial.traffic_type_model ............................... [RUN]
18:32:14.817085 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_type_model"
18:32:14.817331 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_type_model
18:32:14.817492 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_type_model
18:32:14.819660 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_type_model"
18:32:14.819940 [debug] [Thread-1  ]: finished collecting timing info
18:32:14.820077 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_type_model
18:32:14.821994 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_type_model"
18:32:14.822272 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:32:14.822392 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: BEGIN
18:32:14.822493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:32:14.829811 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:32:14.830090 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:32:14.830664 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */

  create view "trial"."trial"."traffic_type_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select " type" , COUNT(id) 
from "trial"."trial"."traffic_dbt_model"
Group by " type"
  );
18:32:14.832517 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:32:14.834869 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:32:14.835042 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */
alter table "trial"."trial"."traffic_type_model__dbt_tmp" rename to "traffic_type_model"
18:32:14.835451 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:32:14.836597 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: COMMIT
18:32:14.836757 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:32:14.836874 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: COMMIT
18:32:14.838056 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:32:14.839335 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:32:14.839457 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */
drop view if exists "trial"."trial"."traffic_type_model__dbt_backup" cascade
18:32:14.839816 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:32:14.840573 [debug] [Thread-1  ]: finished collecting timing info
18:32:14.840737 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: Close
18:32:14.841158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c859e50-2042-4bbf-a31f-5623e8822abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1c639af0>]}
18:32:14.841449 [info ] [Thread-1  ]: 5 of 5 OK created view model trial.traffic_type_model .......................... [[32mCREATE VIEW[0m in 0.02s]
18:32:14.841822 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_type_model
18:32:14.842955 [debug] [MainThread]: Acquiring new postgres connection "master"
18:32:14.843145 [debug] [MainThread]: Using postgres connection "master"
18:32:14.843275 [debug] [MainThread]: On master: BEGIN
18:32:14.843383 [debug] [MainThread]: Opening a new connection, currently in state closed
18:32:14.850792 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:32:14.851053 [debug] [MainThread]: On master: COMMIT
18:32:14.851206 [debug] [MainThread]: Using postgres connection "master"
18:32:14.851356 [debug] [MainThread]: On master: COMMIT
18:32:14.851767 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:32:14.852226 [debug] [MainThread]: On master: Close
18:32:14.852869 [info ] [MainThread]: 
18:32:14.853206 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0.27s.
18:32:14.853576 [debug] [MainThread]: Connection 'master' was properly closed.
18:32:14.853792 [debug] [MainThread]: Connection 'model.datawarehouse.traffic_type_model' was properly closed.
18:32:14.858128 [info ] [MainThread]: 
18:32:14.858392 [info ] [MainThread]: [32mCompleted successfully[0m
18:32:14.858769 [info ] [MainThread]: 
18:32:14.859055 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
18:32:14.859403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1c5b92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1c5b9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1c5b9400>]}


============================== 2022-07-24 18:36:16.224431 | 78b8a53f-ad60-447b-921e-a44384f83012 ==============================
18:36:16.224445 [info ] [MainThread]: Running with dbt=1.1.1
18:36:16.224939 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
18:36:16.225080 [debug] [MainThread]: Tracking: tracking
18:36:16.244680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c75f8dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c75f8dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c75f8dd60>]}
18:36:16.246520 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
18:36:16.246883 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
18:36:16.247142 [info ] [MainThread]: 
18:36:16.247422 [info ] [MainThread]: 
18:36:16.247779 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-07-24 18:49:38.865081 | 78c90648-25fd-4767-aaf0-571c40fa3050 ==============================
18:49:38.865096 [info ] [MainThread]: Running with dbt=1.1.1
18:49:38.865634 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:49:38.865759 [debug] [MainThread]: Tracking: tracking
18:49:38.887723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf82ffabe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf82ffacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf82ffaca0>]}
18:49:38.913913 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
18:49:38.914291 [debug] [MainThread]: Partial parsing: added file: datawarehouse://models/example/traffic_avg_distance_by_type_model.sql
18:49:38.914481 [debug] [MainThread]: Partial parsing: added file: datawarehouse://models/example/traffic_avg_speed_by_type_model.sql
18:49:38.914594 [debug] [MainThread]: Partial parsing: deleted file: datawarehouse://models/example/traffic_distance_model.sql
18:49:38.914724 [debug] [MainThread]: Partial parsing: deleted file: datawarehouse://models/example/traffic_speed_model.sql
18:49:38.924524 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_avg_distance_by_type_model.sql
18:49:38.935492 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_avg_speed_by_type_model.sql
18:49:38.944463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78c90648-25fd-4767-aaf0-571c40fa3050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf81f021c0>]}
18:49:38.949290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78c90648-25fd-4767-aaf0-571c40fa3050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf82f94d60>]}
18:49:38.949616 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:49:38.949900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78c90648-25fd-4767-aaf0-571c40fa3050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf82f94f10>]}
18:49:38.951273 [info ] [MainThread]: 
18:49:38.951897 [debug] [MainThread]: Acquiring new postgres connection "master"
18:49:38.953079 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
18:49:38.963057 [debug] [ThreadPool]: Using postgres connection "list_trial"
18:49:38.963335 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
18:49:38.963511 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:49:38.973951 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:49:38.975262 [debug] [ThreadPool]: On list_trial: Close
18:49:38.976947 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
18:49:38.983065 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:49:38.983258 [debug] [ThreadPool]: On list_trial_trial: BEGIN
18:49:38.983402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:49:38.991378 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:49:38.991594 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:49:38.991717 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
18:49:38.993780 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
18:49:38.995156 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
18:49:38.995500 [debug] [ThreadPool]: On list_trial_trial: Close
18:49:38.999968 [debug] [MainThread]: Using postgres connection "master"
18:49:39.000188 [debug] [MainThread]: On master: BEGIN
18:49:39.000329 [debug] [MainThread]: Opening a new connection, currently in state init
18:49:39.008420 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:49:39.008645 [debug] [MainThread]: Using postgres connection "master"
18:49:39.008903 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:49:39.020414 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
18:49:39.021882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78c90648-25fd-4767-aaf0-571c40fa3050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf81e9f100>]}
18:49:39.022138 [debug] [MainThread]: On master: ROLLBACK
18:49:39.022415 [debug] [MainThread]: Using postgres connection "master"
18:49:39.022550 [debug] [MainThread]: On master: BEGIN
18:49:39.022841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:49:39.022993 [debug] [MainThread]: On master: COMMIT
18:49:39.023112 [debug] [MainThread]: Using postgres connection "master"
18:49:39.023218 [debug] [MainThread]: On master: COMMIT
18:49:39.023383 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:49:39.023517 [debug] [MainThread]: On master: Close
18:49:39.023919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:49:39.024162 [info ] [MainThread]: 
18:49:39.027082 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
18:49:39.027473 [info ] [Thread-1  ]: 1 of 6 START table model trial.my_first_dbt_model .............................. [RUN]
18:49:39.028036 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
18:49:39.028226 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
18:49:39.028405 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
18:49:39.030493 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
18:49:39.030816 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.030989 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
18:49:39.055425 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
18:49:39.055985 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:49:39.056200 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
18:49:39.056353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:39.063643 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:49:39.063872 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:49:39.064008 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:49:39.065349 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:49:39.070065 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:49:39.070285 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:49:39.070781 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:39.072994 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:49:39.073209 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:49:39.073681 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:39.082034 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:49:39.082204 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:49:39.082338 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:49:39.083742 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:49:39.087679 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:49:39.087897 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
18:49:39.090206 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:49:39.091198 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.091368 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
18:49:39.091796 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c90648-25fd-4767-aaf0-571c40fa3050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf81650970>]}
18:49:39.092108 [info ] [Thread-1  ]: 1 of 6 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.06s]
18:49:39.092509 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
18:49:39.092682 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
18:49:39.093093 [info ] [Thread-1  ]: 2 of 6 START view model trial.traffic_dbt_model ................................ [RUN]
18:49:39.093739 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
18:49:39.093906 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
18:49:39.094052 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
18:49:39.095796 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
18:49:39.096049 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.096175 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
18:49:39.109873 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
18:49:39.110288 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:49:39.110465 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
18:49:39.110658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:39.117945 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:49:39.118165 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:49:39.118295 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    

with traffic_dbt_model as (

    select * from datasets

)

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:49:39.119711 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:49:39.123150 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:49:39.123359 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model" rename to "traffic_dbt_model__dbt_backup"
18:49:39.123872 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:39.126280 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:49:39.126560 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model__dbt_tmp" rename to "traffic_dbt_model"
18:49:39.127027 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:39.128183 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:49:39.128327 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:49:39.128446 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:49:39.129834 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:49:39.131721 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:49:39.131851 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
drop view if exists "trial"."trial"."traffic_dbt_model__dbt_backup" cascade
18:49:39.133988 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:49:39.134791 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.134931 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
18:49:39.135325 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c90648-25fd-4767-aaf0-571c40fa3050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8061be20>]}
18:49:39.135591 [info ] [Thread-1  ]: 2 of 6 OK created view model trial.traffic_dbt_model ........................... [[32mCREATE VIEW[0m in 0.04s]
18:49:39.135924 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
18:49:39.136078 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
18:49:39.136375 [info ] [Thread-1  ]: 3 of 6 START view model trial.my_second_dbt_model .............................. [RUN]
18:49:39.137385 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
18:49:39.137631 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
18:49:39.137790 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
18:49:39.140058 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
18:49:39.140433 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.140603 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
18:49:39.142543 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
18:49:39.142928 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:49:39.143111 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
18:49:39.143259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:39.149566 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:49:39.149753 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:49:39.149877 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
18:49:39.151717 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:49:39.154433 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:49:39.154615 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:49:39.155136 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:39.156371 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:49:39.156540 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:49:39.156673 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:49:39.158065 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:49:39.159660 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:49:39.159822 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
18:49:39.160140 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:49:39.161042 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.161220 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
18:49:39.162057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c90648-25fd-4767-aaf0-571c40fa3050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf80649700>]}
18:49:39.162435 [info ] [Thread-1  ]: 3 of 6 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
18:49:39.162915 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
18:49:39.163165 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_avg_distance_by_type_model
18:49:39.163528 [info ] [Thread-1  ]: 4 of 6 START view model trial.traffic_avg_distance_by_type_model ............... [RUN]
18:49:39.164052 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_avg_distance_by_type_model"
18:49:39.164222 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_avg_distance_by_type_model
18:49:39.164377 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_avg_distance_by_type_model
18:49:39.166345 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_avg_distance_by_type_model"
18:49:39.166607 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.166737 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_avg_distance_by_type_model
18:49:39.168254 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_avg_distance_by_type_model"
18:49:39.168478 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_distance_by_type_model"
18:49:39.168600 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_distance_by_type_model: BEGIN
18:49:39.168704 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:39.176310 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:49:39.176752 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_distance_by_type_model"
18:49:39.176903 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_distance_by_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_avg_distance_by_type_model"} */

  create view "trial"."trial"."traffic_avg_distance_by_type_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select " type" , AVG("traveled_d") 
from "trial"."trial"."traffic_dbt_model"
Group by " type"
  );
18:49:39.177712 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "traveled_d" does not exist
LINE 6: select " type" , AVG("traveled_d") 
                             ^
HINT:  Perhaps you meant to reference the column "traffic_dbt_model. traveled_d".

18:49:39.177972 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_distance_by_type_model: ROLLBACK
18:49:39.178348 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.178840 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_distance_by_type_model: Close
18:49:39.179345 [debug] [Thread-1  ]: Database Error in model traffic_avg_distance_by_type_model (models/example/traffic_avg_distance_by_type_model.sql)
  column "traveled_d" does not exist
  LINE 6: select " type" , AVG("traveled_d") 
                               ^
  HINT:  Perhaps you meant to reference the column "traffic_dbt_model. traveled_d".
  compiled SQL at target/run/datawarehouse/models/example/traffic_avg_distance_by_type_model.sql
18:49:39.179663 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c90648-25fd-4767-aaf0-571c40fa3050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf805e23d0>]}
18:49:39.180094 [error] [Thread-1  ]: 4 of 6 ERROR creating view model trial.traffic_avg_distance_by_type_model ...... [[31mERROR[0m in 0.02s]
18:49:39.180527 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_avg_distance_by_type_model
18:49:39.180829 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_avg_speed_by_type_model
18:49:39.181311 [info ] [Thread-1  ]: 5 of 6 START view model trial.traffic_avg_speed_by_type_model .................. [RUN]
18:49:39.182011 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_avg_speed_by_type_model"
18:49:39.182184 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_avg_speed_by_type_model
18:49:39.182407 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_avg_speed_by_type_model
18:49:39.184357 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_avg_speed_by_type_model"
18:49:39.184626 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.184799 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_avg_speed_by_type_model
18:49:39.186336 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_avg_speed_by_type_model"
18:49:39.186561 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_speed_by_type_model"
18:49:39.186680 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_speed_by_type_model: BEGIN
18:49:39.186786 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:39.194929 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:49:39.195291 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_speed_by_type_model"
18:49:39.195511 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_speed_by_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_avg_speed_by_type_model"} */

  create view "trial"."trial"."traffic_avg_speed_by_type_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select " type" , AVG(avg_speed) 
from "trial"."trial"."traffic_dbt_model"
Group by " type"
  );
18:49:39.196181 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "avg_speed" does not exist
LINE 6: select " type" , AVG(avg_speed) 
                             ^
HINT:  Perhaps you meant to reference the column "traffic_dbt_model. avg_speed".

18:49:39.196451 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_speed_by_type_model: ROLLBACK
18:49:39.196875 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.197050 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_speed_by_type_model: Close
18:49:39.197497 [debug] [Thread-1  ]: Database Error in model traffic_avg_speed_by_type_model (models/example/traffic_avg_speed_by_type_model.sql)
  column "avg_speed" does not exist
  LINE 6: select " type" , AVG(avg_speed) 
                               ^
  HINT:  Perhaps you meant to reference the column "traffic_dbt_model. avg_speed".
  compiled SQL at target/run/datawarehouse/models/example/traffic_avg_speed_by_type_model.sql
18:49:39.198031 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c90648-25fd-4767-aaf0-571c40fa3050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf80600940>]}
18:49:39.198386 [error] [Thread-1  ]: 5 of 6 ERROR creating view model trial.traffic_avg_speed_by_type_model ......... [[31mERROR[0m in 0.02s]
18:49:39.198779 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_avg_speed_by_type_model
18:49:39.199032 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_type_model
18:49:39.199321 [info ] [Thread-1  ]: 6 of 6 START view model trial.traffic_type_model ............................... [RUN]
18:49:39.199978 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_type_model"
18:49:39.200215 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_type_model
18:49:39.200365 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_type_model
18:49:39.202434 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_type_model"
18:49:39.202751 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.202892 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_type_model
18:49:39.205095 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_type_model"
18:49:39.205497 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:49:39.205656 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: BEGIN
18:49:39.205807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:39.213539 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:49:39.213798 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:49:39.213943 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */

  create view "trial"."trial"."traffic_type_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select " type" , COUNT(id) 
from "trial"."trial"."traffic_dbt_model"
Group by " type"
  );
18:49:39.215283 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:49:39.217260 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:49:39.217417 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */
alter table "trial"."trial"."traffic_type_model__dbt_tmp" rename to "traffic_type_model"
18:49:39.217812 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:39.218694 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: COMMIT
18:49:39.218809 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:49:39.218903 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: COMMIT
18:49:39.220060 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:49:39.221144 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:49:39.221256 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */
drop view if exists "trial"."trial"."traffic_type_model__dbt_backup" cascade
18:49:39.221438 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:49:39.222164 [debug] [Thread-1  ]: finished collecting timing info
18:49:39.222342 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: Close
18:49:39.223096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c90648-25fd-4767-aaf0-571c40fa3050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf805ad280>]}
18:49:39.223463 [info ] [Thread-1  ]: 6 of 6 OK created view model trial.traffic_type_model .......................... [[32mCREATE VIEW[0m in 0.02s]
18:49:39.223887 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_type_model
18:49:39.225037 [debug] [MainThread]: Acquiring new postgres connection "master"
18:49:39.225262 [debug] [MainThread]: Using postgres connection "master"
18:49:39.225409 [debug] [MainThread]: On master: BEGIN
18:49:39.225550 [debug] [MainThread]: Opening a new connection, currently in state closed
18:49:39.233241 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:49:39.233493 [debug] [MainThread]: On master: COMMIT
18:49:39.233631 [debug] [MainThread]: Using postgres connection "master"
18:49:39.233750 [debug] [MainThread]: On master: COMMIT
18:49:39.233951 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:49:39.234092 [debug] [MainThread]: On master: Close
18:49:39.234544 [info ] [MainThread]: 
18:49:39.234827 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0.28s.
18:49:39.235050 [debug] [MainThread]: Connection 'master' was properly closed.
18:49:39.235163 [debug] [MainThread]: Connection 'model.datawarehouse.traffic_type_model' was properly closed.
18:49:39.240712 [info ] [MainThread]: 
18:49:39.241418 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:49:39.242044 [info ] [MainThread]: 
18:49:39.242524 [error] [MainThread]: [33mDatabase Error in model traffic_avg_distance_by_type_model (models/example/traffic_avg_distance_by_type_model.sql)[0m
18:49:39.242987 [error] [MainThread]:   column "traveled_d" does not exist
18:49:39.243379 [error] [MainThread]:   LINE 6: select " type" , AVG("traveled_d") 
18:49:39.243789 [error] [MainThread]:                                ^
18:49:39.244195 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "traffic_dbt_model. traveled_d".
18:49:39.244599 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_avg_distance_by_type_model.sql
18:49:39.245160 [info ] [MainThread]: 
18:49:39.245590 [error] [MainThread]: [33mDatabase Error in model traffic_avg_speed_by_type_model (models/example/traffic_avg_speed_by_type_model.sql)[0m
18:49:39.246013 [error] [MainThread]:   column "avg_speed" does not exist
18:49:39.246424 [error] [MainThread]:   LINE 6: select " type" , AVG(avg_speed) 
18:49:39.246797 [error] [MainThread]:                                ^
18:49:39.247173 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "traffic_dbt_model. avg_speed".
18:49:39.247583 [error] [MainThread]:   compiled SQL at target/run/datawarehouse/models/example/traffic_avg_speed_by_type_model.sql
18:49:39.247983 [info ] [MainThread]: 
18:49:39.248604 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
18:49:39.249137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf81eba3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf81ebad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf81ebadf0>]}


============================== 2022-07-24 18:50:03.218588 | a1c4fc81-4212-4746-ac2f-a4fb38ed2ac2 ==============================
18:50:03.218600 [info ] [MainThread]: Running with dbt=1.1.1
18:50:03.219139 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:50:03.219281 [debug] [MainThread]: Tracking: tracking
18:50:03.239529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f0013c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f0013d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f0013cd0>]}
18:50:03.264771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
18:50:03.265218 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_avg_distance_by_type_model.sql
18:50:03.265451 [debug] [MainThread]: Partial parsing: updated file: datawarehouse://models/example/traffic_avg_speed_by_type_model.sql
18:50:03.274671 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_avg_distance_by_type_model.sql
18:50:03.285493 [debug] [MainThread]: 1699: static parser successfully parsed example/traffic_avg_speed_by_type_model.sql
18:50:03.292094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1c4fc81-4212-4746-ac2f-a4fb38ed2ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eef1c4f0>]}
18:50:03.295306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1c4fc81-4212-4746-ac2f-a4fb38ed2ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8effaedf0>]}
18:50:03.295545 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:50:03.295773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c4fc81-4212-4746-ac2f-a4fb38ed2ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8effaefd0>]}
18:50:03.296964 [info ] [MainThread]: 
18:50:03.297470 [debug] [MainThread]: Acquiring new postgres connection "master"
18:50:03.298581 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial"
18:50:03.307236 [debug] [ThreadPool]: Using postgres connection "list_trial"
18:50:03.307500 [debug] [ThreadPool]: On list_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial"} */

    select distinct nspname from pg_namespace
  
18:50:03.307633 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:50:03.316610 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:50:03.318915 [debug] [ThreadPool]: On list_trial: Close
18:50:03.320856 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
18:50:03.326242 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:50:03.326383 [debug] [ThreadPool]: On list_trial_trial: BEGIN
18:50:03.326492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:50:03.333571 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:50:03.333824 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
18:50:03.334280 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
18:50:03.336484 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
18:50:03.337631 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
18:50:03.338070 [debug] [ThreadPool]: On list_trial_trial: Close
18:50:03.342359 [debug] [MainThread]: Using postgres connection "master"
18:50:03.342568 [debug] [MainThread]: On master: BEGIN
18:50:03.342709 [debug] [MainThread]: Opening a new connection, currently in state init
18:50:03.350674 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:50:03.350904 [debug] [MainThread]: Using postgres connection "master"
18:50:03.351075 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:50:03.362830 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
18:50:03.364213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c4fc81-4212-4746-ac2f-a4fb38ed2ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eeeda190>]}
18:50:03.364455 [debug] [MainThread]: On master: ROLLBACK
18:50:03.364688 [debug] [MainThread]: Using postgres connection "master"
18:50:03.364818 [debug] [MainThread]: On master: BEGIN
18:50:03.365427 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:50:03.365658 [debug] [MainThread]: On master: COMMIT
18:50:03.365846 [debug] [MainThread]: Using postgres connection "master"
18:50:03.366017 [debug] [MainThread]: On master: COMMIT
18:50:03.366406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:50:03.366569 [debug] [MainThread]: On master: Close
18:50:03.366970 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:50:03.367221 [info ] [MainThread]: 
18:50:03.369873 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
18:50:03.370228 [info ] [Thread-1  ]: 1 of 6 START table model trial.my_first_dbt_model .............................. [RUN]
18:50:03.370781 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
18:50:03.370936 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
18:50:03.371159 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
18:50:03.373186 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
18:50:03.373472 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.373625 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
18:50:03.396599 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_first_dbt_model"
18:50:03.397062 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:50:03.397266 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: BEGIN
18:50:03.397409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:50:03.404691 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:50:03.405293 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:50:03.405438 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */


  create  table "trial"."trial"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:50:03.406658 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:50:03.414632 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:50:03.414860 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:50:03.415660 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:03.417917 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:50:03.418093 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
alter table "trial"."trial"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:50:03.418738 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:03.427067 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:50:03.427209 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:50:03.427308 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: COMMIT
18:50:03.429075 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:50:03.431958 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_first_dbt_model"
18:50:03.432071 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_first_dbt_model"} */
drop table if exists "trial"."trial"."my_first_dbt_model__dbt_backup" cascade
18:50:03.434760 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:50:03.435572 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.435715 [debug] [Thread-1  ]: On model.datawarehouse.my_first_dbt_model: Close
18:50:03.436126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c4fc81-4212-4746-ac2f-a4fb38ed2ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ee669970>]}
18:50:03.436400 [info ] [Thread-1  ]: 1 of 6 OK created table model trial.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.07s]
18:50:03.436776 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
18:50:03.437255 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
18:50:03.437667 [info ] [Thread-1  ]: 2 of 6 START view model trial.traffic_dbt_model ................................ [RUN]
18:50:03.438382 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
18:50:03.438559 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
18:50:03.438762 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
18:50:03.441202 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
18:50:03.441675 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.441926 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
18:50:03.459675 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_dbt_model"
18:50:03.460052 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:50:03.460194 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: BEGIN
18:50:03.460300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:50:03.467713 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:50:03.468201 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:50:03.468507 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */

  create view "trial"."trial"."traffic_dbt_model__dbt_tmp" as (
    

with traffic_dbt_model as (

    select * from datasets

)

select *
from traffic_dbt_model

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:50:03.470841 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:50:03.472881 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:50:03.473008 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model" rename to "traffic_dbt_model__dbt_backup"
18:50:03.473574 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:03.475100 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:50:03.475213 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
alter table "trial"."trial"."traffic_dbt_model__dbt_tmp" rename to "traffic_dbt_model"
18:50:03.475673 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:03.476539 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:50:03.476676 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:50:03.476961 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: COMMIT
18:50:03.478555 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:50:03.480834 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_dbt_model"
18:50:03.480974 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_dbt_model"} */
drop view if exists "trial"."trial"."traffic_dbt_model__dbt_backup" cascade
18:50:03.482909 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:50:03.483830 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.483993 [debug] [Thread-1  ]: On model.datawarehouse.traffic_dbt_model: Close
18:50:03.484416 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c4fc81-4212-4746-ac2f-a4fb38ed2ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ece310d0>]}
18:50:03.484749 [info ] [Thread-1  ]: 2 of 6 OK created view model trial.traffic_dbt_model ........................... [[32mCREATE VIEW[0m in 0.05s]
18:50:03.485289 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
18:50:03.485465 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
18:50:03.485660 [info ] [Thread-1  ]: 3 of 6 START view model trial.my_second_dbt_model .............................. [RUN]
18:50:03.486536 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
18:50:03.486715 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
18:50:03.486845 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
18:50:03.488727 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
18:50:03.489390 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.489565 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
18:50:03.491328 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.my_second_dbt_model"
18:50:03.491612 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:50:03.491753 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: BEGIN
18:50:03.491873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:50:03.499450 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:50:03.499765 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:50:03.499960 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */

  create view "trial"."trial"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "trial"."trial"."my_first_dbt_model"
where id = 1
  );
18:50:03.501770 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:50:03.503838 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:50:03.503995 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
alter table "trial"."trial"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:50:03.504466 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:03.505443 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:50:03.505562 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:50:03.505657 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: COMMIT
18:50:03.506897 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:50:03.508327 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.my_second_dbt_model"
18:50:03.508457 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.my_second_dbt_model"} */
drop view if exists "trial"."trial"."my_second_dbt_model__dbt_backup" cascade
18:50:03.508704 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:50:03.509888 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.510048 [debug] [Thread-1  ]: On model.datawarehouse.my_second_dbt_model: Close
18:50:03.510457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c4fc81-4212-4746-ac2f-a4fb38ed2ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ece5e5b0>]}
18:50:03.510761 [info ] [Thread-1  ]: 3 of 6 OK created view model trial.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.02s]
18:50:03.511149 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
18:50:03.511714 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_avg_distance_by_type_model
18:50:03.512081 [info ] [Thread-1  ]: 4 of 6 START view model trial.traffic_avg_distance_by_type_model ............... [RUN]
18:50:03.513076 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_avg_distance_by_type_model"
18:50:03.513358 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_avg_distance_by_type_model
18:50:03.513615 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_avg_distance_by_type_model
18:50:03.516612 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_avg_distance_by_type_model"
18:50:03.517236 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.517469 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_avg_distance_by_type_model
18:50:03.520197 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_avg_distance_by_type_model"
18:50:03.520588 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_distance_by_type_model"
18:50:03.520803 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_distance_by_type_model: BEGIN
18:50:03.520949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:50:03.527691 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:50:03.527869 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_distance_by_type_model"
18:50:03.528334 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_distance_by_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_avg_distance_by_type_model"} */

  create view "trial"."trial"."traffic_avg_distance_by_type_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select " type" , AVG(" traveled_d") 
from "trial"."trial"."traffic_dbt_model"
Group by " type"
  );
18:50:03.530662 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:50:03.534088 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_distance_by_type_model"
18:50:03.534320 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_distance_by_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_avg_distance_by_type_model"} */
alter table "trial"."trial"."traffic_avg_distance_by_type_model__dbt_tmp" rename to "traffic_avg_distance_by_type_model"
18:50:03.535209 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:03.537002 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_distance_by_type_model: COMMIT
18:50:03.537242 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_distance_by_type_model"
18:50:03.537470 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_distance_by_type_model: COMMIT
18:50:03.539029 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:50:03.540647 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_distance_by_type_model"
18:50:03.540850 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_distance_by_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_avg_distance_by_type_model"} */
drop view if exists "trial"."trial"."traffic_avg_distance_by_type_model__dbt_backup" cascade
18:50:03.541321 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:50:03.542222 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.542395 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_distance_by_type_model: Close
18:50:03.542848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c4fc81-4212-4746-ac2f-a4fb38ed2ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eeed0d00>]}
18:50:03.543167 [info ] [Thread-1  ]: 4 of 6 OK created view model trial.traffic_avg_distance_by_type_model .......... [[32mCREATE VIEW[0m in 0.03s]
18:50:03.543544 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_avg_distance_by_type_model
18:50:03.543712 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_avg_speed_by_type_model
18:50:03.544065 [info ] [Thread-1  ]: 5 of 6 START view model trial.traffic_avg_speed_by_type_model .................. [RUN]
18:50:03.544924 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_avg_speed_by_type_model"
18:50:03.545165 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_avg_speed_by_type_model
18:50:03.545367 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_avg_speed_by_type_model
18:50:03.547380 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_avg_speed_by_type_model"
18:50:03.547747 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.547928 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_avg_speed_by_type_model
18:50:03.549901 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_avg_speed_by_type_model"
18:50:03.550221 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_speed_by_type_model"
18:50:03.550367 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_speed_by_type_model: BEGIN
18:50:03.550495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:50:03.557736 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:50:03.557979 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_speed_by_type_model"
18:50:03.558120 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_speed_by_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_avg_speed_by_type_model"} */

  create view "trial"."trial"."traffic_avg_speed_by_type_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select " type" , AVG(" avg_speed") 
from "trial"."trial"."traffic_dbt_model"
Group by " type"
  );
18:50:03.559545 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:50:03.561710 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_speed_by_type_model"
18:50:03.561941 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_speed_by_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_avg_speed_by_type_model"} */
alter table "trial"."trial"."traffic_avg_speed_by_type_model__dbt_tmp" rename to "traffic_avg_speed_by_type_model"
18:50:03.562409 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:03.563576 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_speed_by_type_model: COMMIT
18:50:03.563747 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_speed_by_type_model"
18:50:03.563878 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_speed_by_type_model: COMMIT
18:50:03.565045 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:50:03.566550 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_avg_speed_by_type_model"
18:50:03.566734 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_speed_by_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_avg_speed_by_type_model"} */
drop view if exists "trial"."trial"."traffic_avg_speed_by_type_model__dbt_backup" cascade
18:50:03.567028 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:50:03.568381 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.568579 [debug] [Thread-1  ]: On model.datawarehouse.traffic_avg_speed_by_type_model: Close
18:50:03.569131 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c4fc81-4212-4746-ac2f-a4fb38ed2ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ece040a0>]}
18:50:03.569500 [info ] [Thread-1  ]: 5 of 6 OK created view model trial.traffic_avg_speed_by_type_model ............. [[32mCREATE VIEW[0m in 0.02s]
18:50:03.569915 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_avg_speed_by_type_model
18:50:03.570098 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_type_model
18:50:03.570482 [info ] [Thread-1  ]: 6 of 6 START view model trial.traffic_type_model ............................... [RUN]
18:50:03.571023 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_type_model"
18:50:03.571249 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_type_model
18:50:03.571398 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_type_model
18:50:03.573280 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_type_model"
18:50:03.573586 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.573727 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_type_model
18:50:03.576081 [debug] [Thread-1  ]: Writing runtime SQL for node "model.datawarehouse.traffic_type_model"
18:50:03.576328 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:50:03.576454 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: BEGIN
18:50:03.576582 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:50:03.584474 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:50:03.584775 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:50:03.584918 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */

  create view "trial"."trial"."traffic_type_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select " type" , COUNT(id) 
from "trial"."trial"."traffic_dbt_model"
Group by " type"
  );
18:50:03.586800 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:50:03.588916 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:50:03.589089 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */
alter table "trial"."trial"."traffic_type_model__dbt_tmp" rename to "traffic_type_model"
18:50:03.589500 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:03.590466 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: COMMIT
18:50:03.590596 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:50:03.590699 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: COMMIT
18:50:03.591874 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:50:03.593046 [debug] [Thread-1  ]: Using postgres connection "model.datawarehouse.traffic_type_model"
18:50:03.593183 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "node_id": "model.datawarehouse.traffic_type_model"} */
drop view if exists "trial"."trial"."traffic_type_model__dbt_backup" cascade
18:50:03.593396 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:50:03.594530 [debug] [Thread-1  ]: finished collecting timing info
18:50:03.594725 [debug] [Thread-1  ]: On model.datawarehouse.traffic_type_model: Close
18:50:03.595193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c4fc81-4212-4746-ac2f-a4fb38ed2ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ecdc2940>]}
18:50:03.595559 [info ] [Thread-1  ]: 6 of 6 OK created view model trial.traffic_type_model .......................... [[32mCREATE VIEW[0m in 0.02s]
18:50:03.595987 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_type_model
18:50:03.597305 [debug] [MainThread]: Acquiring new postgres connection "master"
18:50:03.597660 [debug] [MainThread]: Using postgres connection "master"
18:50:03.597895 [debug] [MainThread]: On master: BEGIN
18:50:03.598115 [debug] [MainThread]: Opening a new connection, currently in state closed
18:50:03.606005 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:50:03.606257 [debug] [MainThread]: On master: COMMIT
18:50:03.606399 [debug] [MainThread]: Using postgres connection "master"
18:50:03.606533 [debug] [MainThread]: On master: COMMIT
18:50:03.606703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:50:03.606845 [debug] [MainThread]: On master: Close
18:50:03.607321 [info ] [MainThread]: 
18:50:03.607620 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0.31s.
18:50:03.607850 [debug] [MainThread]: Connection 'master' was properly closed.
18:50:03.607966 [debug] [MainThread]: Connection 'model.datawarehouse.traffic_type_model' was properly closed.
18:50:03.611814 [info ] [MainThread]: 
18:50:03.612140 [info ] [MainThread]: [32mCompleted successfully[0m
18:50:03.612433 [info ] [MainThread]: 
18:50:03.612839 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
18:50:03.613308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eeed4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eeed4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eeed4f70>]}


============================== 2022-07-24 19:17:32.540661 | df0437f0-0943-4e62-a250-8dc6ea495b69 ==============================
19:17:32.540678 [info ] [MainThread]: Running with dbt=1.1.1
19:17:32.541316 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/hp/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
19:17:32.541477 [debug] [MainThread]: Tracking: tracking
19:17:32.566192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa944129c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa944129d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa944129d00>]}
19:17:32.598170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:17:32.598455 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:17:32.605596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df0437f0-0943-4e62-a250-8dc6ea495b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa944052610>]}
19:17:32.609895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df0437f0-0943-4e62-a250-8dc6ea495b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9440c3dc0>]}
19:17:32.610205 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:17:32.610486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df0437f0-0943-4e62-a250-8dc6ea495b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9440c3d30>]}
19:17:32.611866 [info ] [MainThread]: 
19:17:32.612425 [debug] [MainThread]: Acquiring new postgres connection "master"
19:17:32.613918 [debug] [ThreadPool]: Acquiring new postgres connection "list_trial_trial"
19:17:32.624455 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:17:32.624882 [debug] [ThreadPool]: On list_trial_trial: BEGIN
19:17:32.625069 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:17:32.648561 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
19:17:32.648862 [debug] [ThreadPool]: Using postgres connection "list_trial_trial"
19:17:32.649022 [debug] [ThreadPool]: On list_trial_trial: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "list_trial_trial"} */
select
      'trial' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trial'
    union all
    select
      'trial' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trial'
  
19:17:32.651952 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
19:17:32.653741 [debug] [ThreadPool]: On list_trial_trial: ROLLBACK
19:17:32.654272 [debug] [ThreadPool]: On list_trial_trial: Close
19:17:32.661220 [debug] [MainThread]: Using postgres connection "master"
19:17:32.661467 [debug] [MainThread]: On master: BEGIN
19:17:32.661607 [debug] [MainThread]: Opening a new connection, currently in state init
19:17:32.672033 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:17:32.672453 [debug] [MainThread]: Using postgres connection "master"
19:17:32.672667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:17:32.690351 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
19:17:32.691772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df0437f0-0943-4e62-a250-8dc6ea495b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9440b7e80>]}
19:17:32.692113 [debug] [MainThread]: On master: ROLLBACK
19:17:32.692473 [debug] [MainThread]: On master: Close
19:17:32.693126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:17:32.693479 [info ] [MainThread]: 
19:17:32.696649 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_first_dbt_model
19:17:32.697401 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_first_dbt_model"
19:17:32.697603 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_first_dbt_model
19:17:32.697800 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_first_dbt_model
19:17:32.699992 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_first_dbt_model"
19:17:32.700331 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.700509 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_first_dbt_model
19:17:32.700668 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.701187 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_first_dbt_model
19:17:32.701393 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_dbt_model
19:17:32.701719 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_dbt_model"
19:17:32.702006 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_dbt_model
19:17:32.702600 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_dbt_model
19:17:32.704900 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_dbt_model"
19:17:32.705346 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.705548 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_dbt_model
19:17:32.705701 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.706167 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_dbt_model
19:17:32.706356 [debug] [Thread-1  ]: Began running node model.datawarehouse.my_second_dbt_model
19:17:32.706893 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.my_second_dbt_model"
19:17:32.707076 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.my_second_dbt_model
19:17:32.707219 [debug] [Thread-1  ]: Compiling model.datawarehouse.my_second_dbt_model
19:17:32.710146 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.my_second_dbt_model"
19:17:32.710623 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.710977 [debug] [Thread-1  ]: Began executing node model.datawarehouse.my_second_dbt_model
19:17:32.711233 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.712146 [debug] [Thread-1  ]: Finished running node model.datawarehouse.my_second_dbt_model
19:17:32.712726 [debug] [Thread-1  ]: Began running node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
19:17:32.713676 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710"
19:17:32.713991 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
19:17:32.714154 [debug] [Thread-1  ]: Compiling test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
19:17:32.727236 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710"
19:17:32.727608 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.727780 [debug] [Thread-1  ]: Began executing node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
19:17:32.727909 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.728334 [debug] [Thread-1  ]: Finished running node test.datawarehouse.not_null_my_first_dbt_model_id.5fb22c2710
19:17:32.728512 [debug] [Thread-1  ]: Began running node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
19:17:32.728939 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.unique_my_first_dbt_model_id.16e066b321"
19:17:32.729096 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
19:17:32.729231 [debug] [Thread-1  ]: Compiling test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
19:17:32.738319 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.unique_my_first_dbt_model_id.16e066b321"
19:17:32.739037 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.739358 [debug] [Thread-1  ]: Began executing node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
19:17:32.739617 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.740289 [debug] [Thread-1  ]: Finished running node test.datawarehouse.unique_my_first_dbt_model_id.16e066b321
19:17:32.740560 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_avg_distance_by_type_model
19:17:32.741074 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_avg_distance_by_type_model"
19:17:32.741263 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_avg_distance_by_type_model
19:17:32.741419 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_avg_distance_by_type_model
19:17:32.743410 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_avg_distance_by_type_model"
19:17:32.743763 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.743941 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_avg_distance_by_type_model
19:17:32.744091 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.744644 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_avg_distance_by_type_model
19:17:32.744902 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_avg_speed_by_type_model
19:17:32.745828 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_avg_speed_by_type_model"
19:17:32.746015 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_avg_speed_by_type_model
19:17:32.746171 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_avg_speed_by_type_model
19:17:32.748498 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_avg_speed_by_type_model"
19:17:32.748912 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.749114 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_avg_speed_by_type_model
19:17:32.749269 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.749739 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_avg_speed_by_type_model
19:17:32.749938 [debug] [Thread-1  ]: Began running node model.datawarehouse.traffic_type_model
19:17:32.750315 [debug] [Thread-1  ]: Acquiring new postgres connection "model.datawarehouse.traffic_type_model"
19:17:32.750469 [debug] [Thread-1  ]: Began compiling node model.datawarehouse.traffic_type_model
19:17:32.750605 [debug] [Thread-1  ]: Compiling model.datawarehouse.traffic_type_model
19:17:32.754233 [debug] [Thread-1  ]: Writing injected SQL for node "model.datawarehouse.traffic_type_model"
19:17:32.755020 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.755339 [debug] [Thread-1  ]: Began executing node model.datawarehouse.traffic_type_model
19:17:32.755539 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.756428 [debug] [Thread-1  ]: Finished running node model.datawarehouse.traffic_type_model
19:17:32.756875 [debug] [Thread-1  ]: Began running node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
19:17:32.757434 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778"
19:17:32.757741 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
19:17:32.758183 [debug] [Thread-1  ]: Compiling test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
19:17:32.762447 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778"
19:17:32.762773 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.762955 [debug] [Thread-1  ]: Began executing node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
19:17:32.763090 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.763479 [debug] [Thread-1  ]: Finished running node test.datawarehouse.not_null_my_second_dbt_model_id.151b76d778
19:17:32.763648 [debug] [Thread-1  ]: Began running node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
19:17:32.763946 [debug] [Thread-1  ]: Acquiring new postgres connection "test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493"
19:17:32.764096 [debug] [Thread-1  ]: Began compiling node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
19:17:32.764312 [debug] [Thread-1  ]: Compiling test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
19:17:32.767690 [debug] [Thread-1  ]: Writing injected SQL for node "test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493"
19:17:32.768013 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.768179 [debug] [Thread-1  ]: Began executing node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
19:17:32.768313 [debug] [Thread-1  ]: finished collecting timing info
19:17:32.768698 [debug] [Thread-1  ]: Finished running node test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493
19:17:32.769925 [debug] [MainThread]: Connection 'master' was properly closed.
19:17:32.770147 [debug] [MainThread]: Connection 'test.datawarehouse.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:17:32.774023 [info ] [MainThread]: Done.
19:17:32.776196 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
19:17:32.776388 [info ] [MainThread]: Building catalog
19:17:32.778511 [debug] [ThreadPool]: Acquiring new postgres connection "trial.information_schema"
19:17:32.785098 [debug] [ThreadPool]: Using postgres connection "trial.information_schema"
19:17:32.785472 [debug] [ThreadPool]: On trial.information_schema: BEGIN
19:17:32.785778 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:17:32.796788 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:17:32.797337 [debug] [ThreadPool]: Using postgres connection "trial.information_schema"
19:17:32.797674 [debug] [ThreadPool]: On trial.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "datawarehouse", "target_name": "dev", "connection_name": "trial.information_schema"} */

    
    

    select
        'trial' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('trial'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
19:17:32.804599 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.01 seconds
19:17:32.811557 [debug] [ThreadPool]: On trial.information_schema: ROLLBACK
19:17:32.812186 [debug] [ThreadPool]: On trial.information_schema: Close
19:17:32.818718 [info ] [MainThread]: Catalog written to /home/hp/Downloads/datawarehouse/target/catalog.json
19:17:32.819263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa944129c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa941f4f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa941f4f6a0>]}
19:17:52.838283 [warn ] [MainThread]: Error sending message, disabling tracking
19:17:52.838887 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
19:17:52.839203 [debug] [MainThread]: Connection 'trial.information_schema' was properly closed.
